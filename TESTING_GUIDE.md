# 藍圖頁面修復測試指南

## 概述

此文件提供詳細的測試步驟，用於驗證藍圖頁面載入問題的修復效果。

## 已修復的問題

1. ✅ BugOutline 圖示未註冊
2. ✅ DatePipe zh-TW locale 錯誤
3. ✅ nz-tabset 棄用警告

## 測試環境準備

### 1. 安裝依賴

```bash
# 使用 Yarn (推薦)
yarn install

# 或使用 npm
npm install
```

### 2. 啟動開發伺服器

```bash
# 使用 Yarn
yarn start

# 或使用 npm
npm start
```

等待編譯完成，預期應該在 `http://localhost:4200` 開啟瀏覽器。

## 測試檢查清單

### A. 控制台錯誤檢查

開啟瀏覽器開發者工具 (F12)，切換到 Console 分頁。

#### ✅ 應該**不再出現**的錯誤：

1. ❌ `icon 'bug' does not exist or is not registered`
2. ❌ `GET http://localhost:4200/assets/outline/bug.svg 404 (Not Found)`
3. ❌ `NG0701: Missing locale data for the locale "zh-TW"` for DatePipe
4. ❌ `InvalidPipeArgument` at overview.component.ts:1005

#### ⚠️ 應該**不再出現**的警告：

1. ⚠️ `[NG-ZORRO]: <NZ-TABSET> is deprecated, please use <NZ-TABS> instead`

### B. 藍圖頁面功能測試

#### 1. 導航到藍圖頁面

1. 登入系統（如果需要）
2. 從左側選單或主頁導航到藍圖列表
3. 點擊任一藍圖進入藍圖概覽頁面

**預期結果:**
- ✅ 頁面正常載入，無持續旋轉的載入圖示
- ✅ 顯示完整的藍圖資訊，而非只有標題

#### 2. 檢查藍圖概覽頁面內容

**應該正確顯示的元素:**

##### Header Section (頁首區塊)
- ✅ 藍圖封面圖片或預設圖示
- ✅ 藍圖名稱 (h1 標題)
- ✅ 藍圖標籤 (公開/私有, 狀態)
- ✅ 編輯按鈕

##### Description Card (描述卡片)
- ✅ 藍圖描述文字（如果有）

##### Statistics Cards (統計卡片)
- ✅ 啟用模組數量
- ✅ 成員數量
- ✅ **建立時間** (格式: yyyy/MM/dd) - **重點測試項目**
- ✅ **更新時間** (格式: yyyy/MM/dd) - **重點測試項目**

**測試重點:**
- 建立時間和更新時間應該顯示為有效的日期格式 (例如: 2025/01/08)
- 不應該顯示為 "Invalid Date" 或空白
- 不應該在控制台出現 DatePipe 錯誤

##### Tab Navigation (標籤頁導航)
- ✅ 標籤頁正確顯示: 概覽、任務管理(如果啟用)、成員管理、財務、活動
- ✅ 點擊標籤頁可以正常切換
- ✅ 標籤內容正確載入

#### 3. 測試標籤頁切換

依序點擊每個標籤頁，確認：

1. **概覽標籤**
   - ✅ 顯示藍圖詳情表格
   - ✅ 所有欄位正確填充
   - ✅ 日期格式正確

2. **任務管理標籤** (如果啟用)
   - ✅ 顯示任務統計卡片
   - ✅ 顯示任務預覽表格
   - ✅ 可以點擊"開啟完整視圖"按鈕

3. **成員管理標籤**
   - ✅ 顯示成員列表表格
   - ✅ 顯示成員資訊 (頭像、姓名、電子郵件、角色)
   - ✅ 可以點擊"開啟完整視圖"按鈕

4. **財務標籤**
   - ✅ 顯示財務快速操作按鈕
   - ✅ 顯示財務概覽卡片
   - ✅ 顯示預算資訊和進度條
   - ✅ 顯示合約列表表格

5. **活動標籤**
   - ✅ 顯示活動時間軸
   - ✅ 可以點擊"重新整理"按鈕
   - ✅ 顯示最近的活動記錄

#### 4. 測試應用程式啟動器

1. 點擊頂部導航列的應用程式圖示 (九宮格圖示)

**預期結果:**
- ✅ 下拉選單正常開啟
- ✅ 所有藍圖工具圖示正確顯示
- ✅ **問題追蹤圖示** (bug 圖示) 正確顯示 - **重點測試項目**
- ✅ 無控制台錯誤

**測試重點:**
- 檢查"問題追蹤"項目的圖示是否為蟲子 (bug) 圖示
- 圖示應該正常渲染，無 404 錯誤
- 圖示顏色應該為紅色背景 (bg-error)

### C. 效能測試

#### 1. 頁面載入時間

**測試步驟:**
1. 開啟 Chrome DevTools 的 Network 分頁
2. 重新整理藍圖概覽頁面
3. 觀察載入時間

**預期結果:**
- ✅ 頁面應在 2-3 秒內完成初始載入
- ✅ 無長時間的載入指示器
- ✅ 無 404 錯誤請求

#### 2. 標籤頁切換效能

**測試步驟:**
1. 快速連續切換多個標籤頁
2. 觀察切換流暢度

**預期結果:**
- ✅ 標籤頁切換應該流暢，無明顯延遲
- ✅ 無控制台錯誤或警告

### D. 瀏覽器相容性測試

建議在以下瀏覽器中測試：
- ✅ Chrome/Edge (最新版本)
- ✅ Firefox (最新版本)
- ✅ Safari (如果可用)

## 已知限制和注意事項

### 1. DatePipe Locale 說明

**目前實作:**
- 使用 `zh-CN` locale 來顯示日期
- 格式: `yyyy/MM/dd`

**原因:**
- `zh-TW` locale 未在 Angular 應用中註冊
- `zh-CN` 和 `zh-TW` 的日期格式相同
- 避免控制台錯誤

**未來改進 (可選):**
- 可以在 `i18n.service.ts` 中正確配置 `zh-TW` locale
- 使用動態 locale 根據使用者語言偏好設定

### 2. 翻譯系統

**現況:**
- i18n 系統已正確配置
- 支援 `zh-CN`, `zh-TW`, `en-US` 三種語言
- 翻譯檔案位於 `src/assets/tmp/i18n/`

**測試:**
- 可以透過語言切換功能測試不同語言
- 確認所有文字正確翻譯

### 3. 資料庫連線

**Supabase 配置:**
- URL: `https://obwyowvbsnqsxsnlsbhl.supabase.co`
- 使用 RLS (Row Level Security) 保護資料

**如果藍圖頁面仍然載入不完整:**
1. 檢查 Supabase 資料庫連線狀態
2. 確認資料庫中有有效的藍圖資料
3. 檢查 RLS 政策是否正確配置
4. 檢查使用者權限

## 問題排查

### 問題 1: 頁面持續載入

**可能原因:**
- 資料庫查詢錯誤
- API 端點無回應
- 網路連線問題

**排查步驟:**
1. 開啟 Network 分頁，檢查 API 請求
2. 查看是否有失敗的請求 (紅色)
3. 檢查請求的回應內容
4. 確認 Supabase 服務是否正常運作

### 問題 2: 顯示不完整

**可能原因:**
- 資料不完整
- 元件渲染錯誤
- 權限不足

**排查步驟:**
1. 檢查控制台是否有 JavaScript 錯誤
2. 確認使用者是否有查看藍圖的權限
3. 檢查藍圖資料是否在資料庫中完整存在

### 問題 3: 圖示顯示錯誤

**可能原因:**
- 快取問題
- 圖示未正確載入

**排查步驟:**
1. 硬重新整理頁面 (Ctrl+Shift+R 或 Cmd+Shift+R)
2. 清除瀏覽器快取
3. 確認 `style-icons.ts` 中的圖示已正確註冊

## 測試報告模板

```markdown
## 測試日期: YYYY-MM-DD
## 測試人員: [名稱]
## 瀏覽器: [Chrome/Firefox/Safari] [版本]

### 控制台錯誤檢查
- [ ] 無 BugOutline 圖示錯誤
- [ ] 無 DatePipe locale 錯誤
- [ ] 無 nz-tabset 棄用警告

### 藍圖頁面功能
- [ ] 頁面正常載入
- [ ] 顯示完整內容
- [ ] 建立時間正確顯示
- [ ] 更新時間正確顯示
- [ ] 標籤頁正常切換

### 應用程式啟動器
- [ ] 問題追蹤圖示正常顯示
- [ ] 所有圖示正確渲染

### 效能
- [ ] 頁面載入時間 < 3秒
- [ ] 標籤頁切換流暢

### 問題記錄
[記錄任何發現的問題]

### 總結
[測試總體評價]
```

## 結論

所有前端程式碼問題已修復。如果測試過程中發現藍圖頁面仍然載入不完整或功能不正常，可能是以下原因：

1. **資料庫問題**: 檢查 Supabase 資料庫中的藍圖資料
2. **權限問題**: 確認 RLS 政策和使用者權限
3. **網路問題**: 檢查網路連線和 API 端點
4. **資料完整性**: 確認藍圖相關資料完整存在

請按照上述測試步驟進行系統性的測試，並記錄任何發現的問題。
