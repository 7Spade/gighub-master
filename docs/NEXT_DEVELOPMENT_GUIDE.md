# ğŸ“‹ GigHub ä¸‹ä¸€æ­¥é–‹ç™¼æŒ‡å—

> åŸºæ–¼å°ˆæ¡ˆç¾æ³åˆ†æçš„é–‹ç™¼æ–¹å‘å»ºè­°

**å»ºç«‹æ—¥æœŸ**: 2025-12-02

---

## ğŸ“Š å°ˆæ¡ˆç¾æ³ç¸½è¦½

### åŠŸèƒ½å®Œæˆåº¦æ¦‚è¦½

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å®Œæˆåº¦è©•ä¼°                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ åŸºç¤å±¤ (Foundation Layer)                                       â”‚
â”‚   âœ… èªè­‰ç³»çµ± (Supabase Auth)                 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ å®Œæˆ â”‚
â”‚   âœ… ä½¿ç”¨è€…ç®¡ç†                               â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ å®Œæˆ â”‚
â”‚   âœ… çµ„ç¹”ç®¡ç†                                 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ å®Œæˆ â”‚
â”‚   ğŸ”¶ Bot ç®¡ç†                                 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘ 50%  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å®¹å™¨å±¤ (Container Layer)                                        â”‚
â”‚   âœ… è—åœ–ç³»çµ±                                 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ å®Œæˆ â”‚
â”‚   ğŸ”¶ æ¬Šé™æ§åˆ¶ (RBAC)                          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 70%  â”‚
â”‚   ğŸ”´ äº‹ä»¶ç¸½ç·š                                 â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0%   â”‚
â”‚   ğŸ”´ æœå°‹å¼•æ“                                 â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0%   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ¥­å‹™å±¤ (Business Layer)                                         â”‚
â”‚   ğŸ”¶ ä»»å‹™ç®¡ç†                                 â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 30%  â”‚
â”‚   ğŸ”¶ æ—¥èªŒç®¡ç†                                 â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 15%  â”‚
â”‚   ğŸ”¶ å¾…è¾¦äº‹é …                                 â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 35%  â”‚
â”‚   ğŸ”´ å“è³ªé©—æ”¶                                 â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0%   â”‚
â”‚   ğŸ”´ æª”æ¡ˆç®¡ç†                                 â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0%   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€è¡“æ£§

| å±¤ç´š | æŠ€è¡“ | ç‰ˆæœ¬ |
|------|------|------|
| å‰ç«¯æ¡†æ¶ | Angular (Standalone Components) | 20.3+ |
| UI æ¡†æ¶ | NG-ZORRO + @delon/abc | 20.x |
| ç‹€æ…‹ç®¡ç† | Angular Signals | - |
| å¾Œç«¯æœå‹™ | Supabase (PostgreSQL + Auth) | 2.x |
| å‹åˆ¥ç³»çµ± | TypeScript | 5.9 |

---

## ğŸ¯ é–‹ç™¼å„ªå…ˆç´šå»ºè­°

åŸºæ–¼å°ˆæ¡ˆç¾æ³åˆ†æï¼Œä»¥ä¸‹æ˜¯å»ºè­°çš„é–‹ç™¼å„ªå…ˆé †åºï¼š

### ğŸ”´ æœ€é«˜å„ªå…ˆç´š - ç«‹å³åŸ·è¡Œ (1-2 é€±)

#### 1. ä»»å‹™ç®¡ç†æ¨¡çµ„å®Œå–„ â­â­â­â­â­

**ç¾æ³**ï¼šUI æ¡†æ¶å·²å®Œæˆï¼ˆæ¨¹ç‹€åœ–ã€è¡¨æ ¼ã€çœ‹æ¿è¦–åœ–ï¼‰ï¼Œä½†å¾Œç«¯æ•´åˆä¸å®Œæ•´

**å¾…å®Œæˆé …ç›®**ï¼š
1. **TaskRepository è³‡æ–™å­˜å–å±¤** - é€£æ¥ Supabase
2. **ä»»å‹™ RPC å‡½æ•¸** - å»ºç«‹/æ›´æ–°/åˆªé™¤ä»»å‹™çš„åŸå­æ“ä½œ
3. **ä»»å‹™æŒ‡æ´¾åŠŸèƒ½** - é€£æ¥ `task_assignees` è³‡æ–™è¡¨
4. **é€²åº¦è¨ˆç®—** - å¾è‘‰ç¯€é»å‘ä¸Šè¨ˆç®—çˆ¶ä»»å‹™é€²åº¦
5. **ç§»é™¤ Mock è³‡æ–™** - åˆ‡æ›åˆ°çœŸå¯¦è³‡æ–™åº«æ“ä½œ

**æ¶‰åŠæª”æ¡ˆ**ï¼š
```
src/app/
â”œâ”€â”€ core/infra/repositories/task/        â† å¾…å»ºç«‹
â”œâ”€â”€ shared/services/task/task.service.ts â† éœ€ä¿®æ”¹ï¼ˆç§»é™¤ mockï¼‰
â””â”€â”€ routes/blueprint/tasks/              â† å·²å®Œæˆ UI
```

**ç‚ºä»€éº¼å„ªå…ˆ**ï¼š
- ä»»å‹™æ˜¯æ ¸å¿ƒæ¥­å‹™æ¨¡çµ„ï¼Œæ‰€æœ‰å…¶ä»–åŠŸèƒ½ä¾é™„æ–¼æ­¤
- UI å·²å®Œæˆï¼Œåªéœ€å®Œæˆå¾Œç«¯æ•´åˆ
- è³‡æ–™åº« schema å·²è¨­è¨ˆå®Œæˆ

---

### ğŸŸ  é«˜å„ªå…ˆç´š - çŸ­æœŸç›®æ¨™ (2-4 é€±)

#### 2. æ–½å·¥æ—¥èªŒæ¨¡çµ„ â­â­â­â­

**ç¾æ³**ï¼šè³‡æ–™åº«å·²è¨­è¨ˆï¼Œå‰ç«¯åƒ…æœ‰åˆ—è¡¨æ¡†æ¶

**å¾…å®Œæˆé …ç›®**ï¼š
1. **DiaryRepository** - è³‡æ–™å­˜å–å±¤
2. **æ—¥èªŒå»ºç«‹è¡¨å–®** - å®Œæ•´çš„æ—¥èªŒå¡«å¯« UI
3. **æ—¥èªŒæ¢ç›®ç®¡ç†** - `daily_log_entries` æ•´åˆ
4. **ç…§ç‰‡ä¸Šå‚³** - Supabase Storage æ•´åˆ
5. **å¤©æ°£é¸æ“‡å™¨** - åŸºæ–¼ `weather_type` æšèˆ‰

**ç›¸é—œè³‡æ–™è¡¨**ï¼š
- `daily_logs` - æ—¥èªŒä¸»è¡¨
- `daily_log_entries` - æ—¥èªŒæ¢ç›®

**å•†æ¥­åƒ¹å€¼**ï¼š
- å·¥åœ°ä¸»ä»»æ¯æ—¥å¿…ç”¨åŠŸèƒ½
- æ³•è¦è¦æ±‚çš„æ–½å·¥ç´€éŒ„

#### 3. æª”æ¡ˆç®¡ç†æ¨¡çµ„ â­â­â­â­

**ç¾æ³**ï¼šè³‡æ–™åº«çµæ§‹å·²åœ¨ `seed.sql` ä¸­è¨­è¨ˆï¼Œå‰ç«¯æœªé–‹å§‹

**å¾…å®Œæˆé …ç›®**ï¼š
1. **Supabase Storage é…ç½®** - bucket è¨­å®š
2. **FileRepository** - è³‡æ–™å­˜å–å±¤
3. **FileService** - æ¥­å‹™é‚è¼¯
4. **æª”æ¡ˆä¸Šå‚³å…ƒä»¶** - æ‹–æ‹‰ä¸Šå‚³ UI
5. **æª”æ¡ˆé è¦½** - åœ–ç‰‡/PDF é è¦½

**ä¾è³´é—œä¿‚**ï¼š
- æ—¥èªŒç…§ç‰‡ä¸Šå‚³éœ€è¦æ­¤æ¨¡çµ„
- ä»»å‹™é™„ä»¶éœ€è¦æ­¤æ¨¡çµ„

---

### ğŸŸ¡ ä¸­å„ªå…ˆç´š - ä¸­æœŸç›®æ¨™ (4-6 é€±)

#### 4. æ¬Šé™æ§åˆ¶å®Œå–„ â­â­â­

**ç¾æ³**ï¼šåŸºç¤ RBAC å·²å¯¦ç¾ï¼Œä½†ç´°ç²’åº¦æ¬Šé™æ§åˆ¶ä¸å®Œæ•´

**å¾…å®Œæˆé …ç›®**ï¼š
1. **blueprint_roles æ•´åˆ** - è‡ªè¨‚è§’è‰²ç³»çµ±
2. **æ¬Šé™ Guard å¼·åŒ–** - è·¯ç”±å±¤æ¬Šé™æ§åˆ¶
3. **UI æ¬Šé™æ§åˆ¶** - æŒ‰éˆ•/æ“ä½œçš„æ¢ä»¶é¡¯ç¤º
4. **PermissionDirective** - æ¬Šé™æŒ‡ä»¤

#### 5. ä»»å‹™è©•è«–èˆ‡è¨è«– â­â­â­

**ç¾æ³**ï¼šè³‡æ–™è¡¨å·²è¨­è¨ˆ (`task_comments`)ï¼Œå‰ç«¯æœªå¯¦ç¾

**å¾…å®Œæˆé …ç›®**ï¼š
1. **TaskCommentService** - è©•è«– CRUD
2. **CommentThreadComponent** - è©•è«–åˆ—è¡¨
3. **@æåŠåŠŸèƒ½** - ä½¿ç”¨è€…æåŠ

---

### ğŸŸ¢ ä¸€èˆ¬å„ªå…ˆç´š - é•·æœŸç›®æ¨™ (6+ é€±)

#### 6. å“è³ªé©—æ”¶æ¨¡çµ„ â­â­

**ç¾æ³**ï¼šåƒ…æœ‰è³‡æ–™åº« enum å®šç¾©

**å¾…å»ºç«‹**ï¼š
- æª¢æŸ¥æ¸…å–®ç³»çµ±
- é©—æ”¶æµç¨‹
- é©—æ”¶å ±å‘Š

#### 7. é€šçŸ¥ä¸­å¿ƒ â­â­

**å¾…å»ºç«‹**ï¼š
- é€šçŸ¥è³‡æ–™è¡¨
- å³æ™‚é€šçŸ¥ (Supabase Realtime)
- é€šçŸ¥ UI å…ƒä»¶

#### 8. å ±è¡¨èˆ‡åˆ†æ â­

**å¾…å»ºç«‹**ï¼š
- é€²åº¦å ±è¡¨
- å·¥æ™‚çµ±è¨ˆ
- Dashboard å¼·åŒ–

---

## ğŸ“ å»ºè­°çš„ç›®éŒ„çµæ§‹

### ä»»å‹™æ¨¡çµ„å®Œæ•´çµæ§‹
```
src/app/
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ facades/
â”‚   â”‚   â””â”€â”€ task/
â”‚   â”‚       â”œâ”€â”€ task.facade.ts
â”‚   â”‚       â””â”€â”€ index.ts
â”‚   â””â”€â”€ infra/
â”‚       â”œâ”€â”€ repositories/
â”‚       â”‚   â””â”€â”€ task/
â”‚       â”‚       â”œâ”€â”€ task.repository.ts
â”‚       â”‚       â””â”€â”€ index.ts
â”‚       â””â”€â”€ types/
â”‚           â””â”€â”€ task/
â”‚               â””â”€â”€ index.ts
â”œâ”€â”€ shared/
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ task/
â”‚   â”‚       â”œâ”€â”€ task.service.ts    â† å·²å­˜åœ¨ï¼Œéœ€ä¿®æ”¹
â”‚   â”‚       â””â”€â”€ index.ts
â”‚   â””â”€â”€ models/
â”‚       â””â”€â”€ task/
â”‚           â”œâ”€â”€ task.models.ts
â”‚           â””â”€â”€ index.ts
â””â”€â”€ routes/
    â””â”€â”€ blueprint/
        â””â”€â”€ tasks/                  â† å·²å®Œæˆ
            â”œâ”€â”€ task-list/
            â”œâ”€â”€ task-detail/
            â”œâ”€â”€ task-create/
            â””â”€â”€ components/
```

### æ—¥èªŒæ¨¡çµ„çµæ§‹
```
src/app/
â”œâ”€â”€ core/
â”‚   â””â”€â”€ infra/
â”‚       â””â”€â”€ repositories/
â”‚           â””â”€â”€ diary/
â”‚               â”œâ”€â”€ diary.repository.ts
â”‚               â””â”€â”€ index.ts
â”œâ”€â”€ shared/
â”‚   â””â”€â”€ services/
â”‚       â””â”€â”€ diary/
â”‚           â”œâ”€â”€ diary.service.ts
â”‚           â””â”€â”€ index.ts
â””â”€â”€ routes/
    â””â”€â”€ blueprint/
        â””â”€â”€ diary/
            â”œâ”€â”€ diary-list/
            â”œâ”€â”€ diary-form/
            â”œâ”€â”€ diary-detail/
            â””â”€â”€ components/
```

---

## ğŸ”§ æŠ€è¡“å»ºè­°

### 1. Repository æ¨¡å¼

å»ºè­°æ‰€æœ‰è³‡æ–™å­˜å–éƒ½é€šé Repository å±¤ï¼š

```typescript
// task.repository.ts
@Injectable({ providedIn: 'root' })
export class TaskRepository {
  private readonly supabase = inject(SupabaseService);

  async findByBlueprint(blueprintId: string): Promise<Task[]> {
    const { data, error } = await this.supabase.client
      .from('tasks')
      .select('*')
      .eq('blueprint_id', blueprintId)
      .is('deleted_at', null)
      .order('sort_order');
    
    if (error) throw error;
    return data as Task[];
  }

  async create(request: CreateTaskRequest): Promise<Task> {
    // ä½¿ç”¨ RPC å‡½æ•¸é€²è¡ŒåŸå­æ“ä½œ
    const { data, error } = await this.supabase.client
      .rpc('create_task', { ...request });
    
    if (error) throw error;
    return data;
  }
}
```

### 2. Signal ç‹€æ…‹ç®¡ç†

ä¿æŒç¾æœ‰çš„ Signal æ¨¡å¼ï¼š

```typescript
// task.service.ts
@Injectable({ providedIn: 'root' })
export class TaskService {
  private readonly repo = inject(TaskRepository);
  
  // State signals
  private readonly tasksState = signal<Task[]>([]);
  private readonly loadingState = signal<boolean>(false);
  
  // Readonly signals for consumers
  readonly tasks = this.tasksState.asReadonly();
  readonly loading = this.loadingState.asReadonly();
  
  // Computed signals
  readonly taskTree = computed(() => this.buildTree(this.tasksState()));
}
```

### 3. éŒ¯èª¤è™•ç†

çµ±ä¸€ä½¿ç”¨å°ˆæ¡ˆçš„éŒ¯èª¤è™•ç†æ¨¡å¼ï¼š

```typescript
try {
  await this.taskRepo.create(request);
  this.msg.success('ä»»å‹™å»ºç«‹æˆåŠŸ');
} catch (err) {
  const message = err instanceof Error ? err.message : 'æ“ä½œå¤±æ•—';
  this.msg.error(message);
  throw err;
}
```

---

## ğŸ“ ç«‹å³è¡Œå‹•æ¸…å–®

### æœ¬é€± (Week 1)

- [ ] å»ºç«‹ `TaskRepository` è³‡æ–™å­˜å–å±¤
- [ ] å¯¦ç¾ä»»å‹™ CRUD çš„çœŸå¯¦è³‡æ–™åº«æ“ä½œ
- [ ] ç§»é™¤ `TaskService` ä¸­çš„ mock è³‡æ–™
- [ ] æ¸¬è©¦ä»»å‹™çš„å»ºç«‹ã€æ›´æ–°ã€åˆªé™¤æµç¨‹

### ä¸‹é€± (Week 2)

- [ ] å¯¦ç¾ä»»å‹™æŒ‡æ´¾åŠŸèƒ½
- [ ] å¯¦ç¾çˆ¶ä»»å‹™é€²åº¦è‡ªå‹•è¨ˆç®—
- [ ] æ¸¬è©¦å®Œæ•´çš„ä»»å‹™ç®¡ç†æµç¨‹
- [ ] é–‹å§‹æ—¥èªŒæ¨¡çµ„çš„ Repository å±¤

### ç¬¬ä¸‰é€± (Week 3)

- [ ] å®Œæˆæ—¥èªŒè¡¨å–® UI
- [ ] æ•´åˆ Supabase Storage é€²è¡Œç…§ç‰‡ä¸Šå‚³
- [ ] å¯¦ç¾æ—¥èªŒæ¢ç›®ç®¡ç†

---

## ğŸ“š ç›¸é—œæ–‡ä»¶

- [ç³»çµ±æ¶æ§‹](GigHub_Architecture.md)
- [åŠŸèƒ½æ–‡ä»¶](features/README.md)
- [ç”¢å“éœ€æ±‚](prd/construction-site-management.md)
- [Supabase Schema](../seed.sql)

---

## ğŸ¯ ç¸½çµ

åŸºæ–¼å°ˆæ¡ˆåˆ†æï¼Œ**å»ºè­°çš„é–‹ç™¼é †åº**ç‚ºï¼š

1. **ğŸ“Œ ä»»å‹™æ¨¡çµ„å®Œå–„** - æœ€é«˜å„ªå…ˆï¼Œå·²æœ‰ UI åªéœ€å®Œæˆå¾Œç«¯
2. **ğŸ“Œ æ–½å·¥æ—¥èªŒæ¨¡çµ„** - æ ¸å¿ƒæ¥­å‹™éœ€æ±‚
3. **ğŸ“Œ æª”æ¡ˆç®¡ç†æ¨¡çµ„** - æ”¯æ´æ—¥èªŒå’Œä»»å‹™é™„ä»¶
4. **æ¬Šé™æ§åˆ¶å®Œå–„** - æå‡å®‰å…¨æ€§
5. **å…¶ä»–æ¨¡çµ„** - æŒ‰éœ€é–‹ç™¼

**æœ€é‡è¦çš„ä¸‹ä¸€æ­¥**ï¼šå®Œæˆ `TaskRepository` ä¸¦ç§»é™¤ mock è³‡æ–™ï¼Œè®“ä»»å‹™æ¨¡çµ„å¯ä»¥çœŸæ­£é€£æ¥è³‡æ–™åº«é‹ä½œã€‚

---

**æœ€å¾Œæ›´æ–°**: 2025-12-02
