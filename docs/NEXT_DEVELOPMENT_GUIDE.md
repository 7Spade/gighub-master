# ğŸ“‹ GigHub ä¸‹ä¸€æ­¥é–‹ç™¼æŒ‡å—

> åŸºæ–¼å°ˆæ¡ˆç¾æ³åˆ†æçš„é–‹ç™¼æ–¹å‘å»ºè­°ï¼ˆå·²æ›´æ–°è‡³æœ€æ–°é€²åº¦ï¼‰

**æ›´æ–°æ—¥æœŸ**: 2025-12-03

---

## ğŸ“Š å°ˆæ¡ˆç¾æ³ç¸½è¦½

### åŠŸèƒ½å®Œæˆåº¦æ¦‚è¦½

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å®Œæˆåº¦è©•ä¼°                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ åŸºç¤å±¤ (Foundation Layer)                                       â”‚
â”‚   âœ… èªè­‰ç³»çµ± (Supabase Auth)                 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ å®Œæˆ â”‚
â”‚   âœ… ä½¿ç”¨è€…ç®¡ç†                               â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ å®Œæˆ â”‚
â”‚   âœ… çµ„ç¹”ç®¡ç†                                 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ å®Œæˆ â”‚
â”‚   ğŸ”¶ Bot ç®¡ç†                                 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘ 50%  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å®¹å™¨å±¤ (Container Layer)                                        â”‚
â”‚   âœ… è—åœ–ç³»çµ±                                 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ å®Œæˆ â”‚
â”‚   âœ… è—åœ–æˆå“¡ç®¡ç†                             â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ å®Œæˆ â”‚
â”‚   ğŸ”¶ æ¬Šé™æ§åˆ¶ (RBAC)                          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 70%  â”‚
â”‚   ğŸ”´ äº‹ä»¶ç¸½ç·š                                 â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0%   â”‚
â”‚   ğŸ”´ æœå°‹å¼•æ“                                 â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0%   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ¥­å‹™å±¤ (Business Layer)                                         â”‚
â”‚   âœ… ä»»å‹™ç®¡ç† (Task Module)                   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 85%  â”‚
â”‚   âœ… è²¡å‹™ç®¡ç† (Financial Module)              â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 70%  â”‚
â”‚   ğŸ”¶ æ—¥èªŒç®¡ç† (Diary Module)                  â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 15%  â”‚
â”‚   ğŸ”¶ å¾…è¾¦äº‹é … (Todo Module)                   â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 35%  â”‚
â”‚   ğŸ”´ å“è³ªé©—æ”¶ (Acceptance)                    â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0%   â”‚
â”‚   ğŸ”´ æª”æ¡ˆç®¡ç† (File Module)                   â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0%   â”‚
â”‚   ğŸ”´ å•é¡Œè¿½è¹¤ (Issue Module)                  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0%   â”‚
â”‚   ğŸ”´ é€šçŸ¥ä¸­å¿ƒ (Notification)                  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0%   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ‰ æœ€æ–°å®Œæˆé€²åº¦

ä»¥ä¸‹æ¨¡çµ„å·²æ–¼è¿‘æœŸå®Œæˆé‡å¤§æ›´æ–°ï¼š

| æ¨¡çµ„ | å®Œæˆé …ç›® | ç‹€æ…‹ |
|------|---------|------|
| **ä»»å‹™ç®¡ç†** | TaskRepository + TaskService å®Œæ•´å¯¦ä½œ | âœ… 85% |
| **è—åœ–ç®¡ç†** | BlueprintRepository + BlueprintService å®Œæ•´å¯¦ä½œ | âœ… å®Œæˆ |
| **è²¡å‹™ç®¡ç†** | FinancialRepository + FinancialService å®Œæ•´å¯¦ä½œ | âœ… 70% |
| **è—åœ–æˆå“¡** | BlueprintMemberRepository å®Œæ•´å¯¦ä½œ | âœ… å®Œæˆ |
| **æ¬Šé™æ§åˆ¶** | PermissionService åŸºç¤å¯¦ä½œ | ğŸ”¶ 70% |

### æŠ€è¡“æ¶æ§‹ç¾æ³

| å±¤ç´š | å…ƒä»¶ | ç‹€æ…‹ | èªªæ˜ |
|------|------|------|------|
| **Repository å±¤** | TaskRepository | âœ… å®Œæˆ | å®Œæ•´ CRUD + æŸ¥è©¢é¸é … |
| **Repository å±¤** | BlueprintRepository | âœ… å®Œæˆ | å®Œæ•´ CRUD + æˆå“¡ç®¡ç† |
| **Repository å±¤** | FinancialRepository | âœ… å®Œæˆ | åˆç´„ã€è²»ç”¨ã€è«‹æ¬¾ã€ä»˜æ¬¾ç®¡ç† |
| **Repository å±¤** | DiaryRepository | ğŸ”´ å¾…å»ºç«‹ | æ—¥èªŒè³‡æ–™å­˜å–å±¤ |
| **Repository å±¤** | FileRepository | ğŸ”´ å¾…å»ºç«‹ | æª”æ¡ˆè³‡æ–™å­˜å–å±¤ |
| **Service å±¤** | TaskService | âœ… å®Œæˆ | ä½¿ç”¨ Signals + linkedSignal |
| **Service å±¤** | BlueprintService | âœ… å®Œæˆ | å®Œæ•´æ¥­å‹™é‚è¼¯ |
| **Service å±¤** | FinancialService | âœ… å®Œæˆ | è²¡å‹™æ¥­å‹™é‚è¼¯ |
| **UI å…ƒä»¶** | TasksComponent | âœ… å®Œæˆ | æ¨¹ç‹€/è¡¨æ ¼/çœ‹æ¿è¦–åœ– |
| **UI å…ƒä»¶** | TaskEditDrawerComponent | âœ… å®Œæˆ | ä»»å‹™ç·¨è¼¯æŠ½å±œ |

---

## ğŸ¯ é–‹ç™¼å„ªå…ˆç´šå»ºè­°

åŸºæ–¼å°ˆæ¡ˆç¾æ³åˆ†æï¼Œä»¥ä¸‹æ˜¯å»ºè­°çš„é–‹ç™¼å„ªå…ˆé †åºï¼š

### ğŸ”´ æœ€é«˜å„ªå…ˆç´š - ç«‹å³åŸ·è¡Œ (1-2 é€±)

#### 1. æ–½å·¥æ—¥èªŒæ¨¡çµ„ (Diary Module) â­â­â­â­â­

**ç¾æ³**ï¼šè³‡æ–™åº«å·²è¨­è¨ˆå®Œæˆï¼Œå‰ç«¯å’Œæœå‹™å±¤å°šæœªå¯¦ä½œ

**å¾…å®Œæˆé …ç›®**ï¼š
1. **DiaryRepository** - æ—¥èªŒè³‡æ–™å­˜å–å±¤
2. **DiaryService** - æ—¥èªŒæ¥­å‹™é‚è¼¯ï¼ˆä½¿ç”¨ Signalsï¼‰
3. **æ—¥èªŒåˆ—è¡¨é é¢** - `routes/blueprint/diary/diary-list/`
4. **æ—¥èªŒå»ºç«‹/ç·¨è¼¯è¡¨å–®** - `routes/blueprint/diary/diary-form/`
5. **æ—¥èªŒæ¢ç›®ç®¡ç†** - å·¥ä½œé …ç›®è¨˜éŒ„
6. **å¤©æ°£é¸æ“‡å™¨** - åŸºæ–¼ `weather_type` æšèˆ‰

**å·²æœ‰è³‡æ–™è¡¨**ï¼š
- `diaries` - æ—¥èªŒä¸»è¡¨
- `diary_attachments` - æ—¥èªŒé™„ä»¶

**ç‚ºä»€éº¼å„ªå…ˆ**ï¼š
- å·¥åœ°ä¸»ä»»æ¯æ—¥å¿…ç”¨åŠŸèƒ½
- æ³•è¦è¦æ±‚çš„æ–½å·¥ç´€éŒ„
- è³‡æ–™åº«çµæ§‹å·²å°±ç·’
- å¯åƒè€ƒ TaskModule çš„æ¶æ§‹æ¨¡å¼

**å»ºè­°æª”æ¡ˆçµæ§‹**ï¼š
```
src/app/
â”œâ”€â”€ core/infra/repositories/diary/
â”‚   â”œâ”€â”€ diary.repository.ts      â† å¾…å»ºç«‹
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ shared/services/diary/
â”‚   â”œâ”€â”€ diary.service.ts         â† å¾…å»ºç«‹
â”‚   â””â”€â”€ index.ts
â””â”€â”€ routes/blueprint/diary/
    â”œâ”€â”€ diary-list/              â† å¾…å»ºç«‹
    â”œâ”€â”€ diary-form/              â† å¾…å»ºç«‹
    â””â”€â”€ routes.ts                â† å¾…å»ºç«‹
```

---

### ğŸŸ  é«˜å„ªå…ˆç´š - çŸ­æœŸç›®æ¨™ (2-4 é€±)

#### 2. æª”æ¡ˆç®¡ç†æ¨¡çµ„ (File Module) â­â­â­â­

**ç¾æ³**ï¼šè³‡æ–™åº«çµæ§‹å·²åœ¨ `seed.sql` ä¸­è¨­è¨ˆï¼Œå‰ç«¯æœªé–‹å§‹

**å¾…å®Œæˆé …ç›®**ï¼š
1. **Supabase Storage é…ç½®** - bucket è¨­å®šå’Œæ¬Šé™
2. **FileRepository** - è³‡æ–™å­˜å–å±¤
3. **FileService** - æª”æ¡ˆæ¥­å‹™é‚è¼¯
4. **æª”æ¡ˆä¸Šå‚³å…ƒä»¶** - æ‹–æ‹‰ä¸Šå‚³ UI
5. **æª”æ¡ˆé è¦½** - åœ–ç‰‡/PDF é è¦½
6. **æª”æ¡ˆåˆ†äº«** - `file_shares` è¡¨æ•´åˆ

**å·²æœ‰è³‡æ–™è¡¨**ï¼š
- `files` - æª”æ¡ˆä¸»è¡¨
- `file_shares` - æª”æ¡ˆåˆ†äº«

**ä¾è³´é—œä¿‚**ï¼š
- æ—¥èªŒç…§ç‰‡ä¸Šå‚³éœ€è¦æ­¤æ¨¡çµ„
- ä»»å‹™é™„ä»¶éœ€è¦æ­¤æ¨¡çµ„

#### 3. ä»»å‹™æ¨¡çµ„å®Œå–„ â­â­â­â­

**ç¾æ³**ï¼šæ ¸å¿ƒåŠŸèƒ½å·²å®Œæˆï¼ˆ85%ï¼‰ï¼Œéœ€å®Œå–„ç´°ç¯€

**å¾…å®Œæˆé …ç›®**ï¼š
1. **ç§»é™¤ mock è³‡æ–™ç›¸é—œç¨‹å¼ç¢¼** - æ¸…ç† `generateMockTasks` ç­‰å·²æ£„ç”¨æ–¹æ³•
2. **ä»»å‹™é™„ä»¶åŠŸèƒ½** - æ•´åˆ `task_attachments` è³‡æ–™è¡¨
3. **ä»»å‹™æŒ‡æ´¾é€šçŸ¥** - æ•´åˆé€šçŸ¥ç³»çµ±
4. **ä»»å‹™è©•è«–åŠŸèƒ½** - è¨è«–å’Œç•™è¨€ï¼ˆéœ€æ–°å¢ `task_comments` è¡¨ï¼‰
5. **æ‹–æ›³æ’åº** - ä»»å‹™é †åºèª¿æ•´

---

### ğŸŸ¡ ä¸­å„ªå…ˆç´š - ä¸­æœŸç›®æ¨™ (4-6 é€±)

#### 4. æ¬Šé™æ§åˆ¶å®Œå–„ â­â­â­

**ç¾æ³**ï¼šåŸºç¤ RBAC å·²å¯¦ç¾ï¼ˆ70%ï¼‰ï¼Œç´°ç²’åº¦æ¬Šé™æ§åˆ¶ä¸å®Œæ•´

**å¾…å®Œæˆé …ç›®**ï¼š
1. **blueprint_roles æ•´åˆ** - è‡ªè¨‚è§’è‰²ç³»çµ±
2. **æ¬Šé™ Guard å¼·åŒ–** - è·¯ç”±å±¤æ¬Šé™æ§åˆ¶
3. **UI æ¬Šé™æ§åˆ¶** - æŒ‰éˆ•/æ“ä½œçš„æ¢ä»¶é¡¯ç¤º
4. **PermissionDirective** - æ¬Šé™æŒ‡ä»¤å…ƒä»¶

#### 5. å•é¡Œè¿½è¹¤æ¨¡çµ„ (Issue Module) â­â­â­

**ç¾æ³**ï¼šè³‡æ–™è¡¨å·²è¨­è¨ˆ (`issues`, `issue_comments`)ï¼Œå‰ç«¯æœªå¯¦ç¾

**å¾…å®Œæˆé …ç›®**ï¼š
1. **IssueRepository** - å•é¡Œè³‡æ–™å­˜å–å±¤
2. **IssueService** - å•é¡Œæ¥­å‹™é‚è¼¯
3. **å•é¡Œåˆ—è¡¨/è©³æƒ…é é¢** - UI å…ƒä»¶
4. **å•é¡Œè©•è«–åŠŸèƒ½** - è¨è«–ç•™è¨€

#### 6. é€šçŸ¥ä¸­å¿ƒæ¨¡çµ„ â­â­â­

**ç¾æ³**ï¼šè³‡æ–™è¡¨å·²è¨­è¨ˆ (`notifications`, `notification_preferences`)ï¼Œå‰ç«¯æœªå¯¦ç¾

**å¾…å®Œæˆé …ç›®**ï¼š
1. **NotificationRepository** - é€šçŸ¥è³‡æ–™å­˜å–å±¤
2. **NotificationService** - é€šçŸ¥æ¥­å‹™é‚è¼¯
3. **é€šçŸ¥ä¸­å¿ƒ UI** - é€šçŸ¥åˆ—è¡¨ã€æœªè®€æ¨™è¨˜
4. **Supabase Realtime æ•´åˆ** - å³æ™‚é€šçŸ¥æ¨é€

---

### ğŸŸ¢ ä¸€èˆ¬å„ªå…ˆç´š - é•·æœŸç›®æ¨™ (6+ é€±)

#### 7. å“è³ªé©—æ”¶æ¨¡çµ„ â­â­

**ç¾æ³**ï¼šè³‡æ–™è¡¨å·²è¨­è¨ˆ (`task_acceptances`, `checklists`, `checklist_items`)

**å¾…å»ºç«‹**ï¼š
- é©—æ”¶æ¸…å–®ç³»çµ±
- é©—æ”¶æµç¨‹ç®¡ç†
- é©—æ”¶å ±å‘Šç”¢ç”Ÿ

#### 8. äº‹ä»¶ç¸½ç·šç³»çµ± â­â­

**ç¾æ³**ï¼šè³‡æ–™è¡¨å·²è¨­è¨ˆ (`events`, `event_subscriptions`)

**å¾…å»ºç«‹**ï¼š
- äº‹ä»¶ç™¼å¸ƒ/è¨‚é–±æ©Ÿåˆ¶
- æ¨¡çµ„é–“é€šè¨Š
- è‡ªå‹•åŒ–è§¸ç™¼å™¨

#### 9. æœå°‹å¼•æ“ â­

**ç¾æ³**ï¼šè³‡æ–™è¡¨å·²è¨­è¨ˆ (`search_index`)

**å¾…å»ºç«‹**ï¼š
- å…¨æ–‡æª¢ç´¢åŠŸèƒ½
- æœå°‹çµæœé é¢
- æœå°‹å»ºè­°

---

## ğŸ“ ç¾æœ‰ç›®éŒ„çµæ§‹åƒè€ƒ

### Repository å±¤ï¼ˆå·²å®Œæˆï¼‰
```
src/app/core/infra/repositories/
â”œâ”€â”€ account/
â”‚   â”œâ”€â”€ account.repository.ts    âœ…
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ blueprint/
â”‚   â”œâ”€â”€ blueprint.repository.ts  âœ…
â”‚   â”œâ”€â”€ blueprint-member.repository.ts âœ…
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ financial/
â”‚   â”œâ”€â”€ financial.repository.ts  âœ…
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ task/
â”‚   â”œâ”€â”€ task.repository.ts       âœ…
â”‚   â””â”€â”€ index.ts
â””â”€â”€ index.ts
```

### Service å±¤ï¼ˆå·²å®Œæˆï¼‰
```
src/app/shared/services/
â”œâ”€â”€ account/
â”‚   â””â”€â”€ account.service.ts       âœ…
â”œâ”€â”€ blueprint/
â”‚   â””â”€â”€ blueprint.service.ts     âœ…
â”œâ”€â”€ financial/
â”‚   â””â”€â”€ financial.service.ts     âœ…
â”œâ”€â”€ task/
â”‚   â””â”€â”€ task.service.ts          âœ…
â”œâ”€â”€ menu/
â”‚   â””â”€â”€ menu.service.ts          âœ…
â”œâ”€â”€ permission/
â”‚   â””â”€â”€ permission.service.ts    ğŸ”¶
â””â”€â”€ index.ts
```

### è·¯ç”±é é¢ï¼ˆéƒ¨åˆ†å®Œæˆï¼‰
```
src/app/routes/
â”œâ”€â”€ blueprint/
â”‚   â”œâ”€â”€ list/                    âœ… è—åœ–åˆ—è¡¨
â”‚   â”œâ”€â”€ create-blueprint/        âœ… å»ºç«‹è—åœ–
â”‚   â”œâ”€â”€ overview/                âœ… è—åœ–ç¸½è¦½
â”‚   â”œâ”€â”€ members/                 âœ… æˆå“¡ç®¡ç†
â”‚   â”œâ”€â”€ tasks/                   âœ… ä»»å‹™ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ tasks.component.ts
â”‚   â”‚   â””â”€â”€ task-edit-drawer.component.ts
â”‚   â”œâ”€â”€ diary/                   ğŸ”´ å¾…å»ºç«‹
â”‚   â”œâ”€â”€ files/                   ğŸ”´ å¾…å»ºç«‹
â”‚   â””â”€â”€ routes.ts
â”œâ”€â”€ account/                     âœ…
â”œâ”€â”€ passport/                    âœ…
â””â”€â”€ ...
```

---

## ğŸ”§ æŠ€è¡“å¯¦ä½œå»ºè­°

### 1. DiaryRepository åƒè€ƒå¯¦ä½œ

```typescript
// src/app/core/infra/repositories/diary/diary.repository.ts
import { Injectable, inject } from '@angular/core';
import { Observable, from, map } from 'rxjs';
import { SupabaseService } from '@core/supabase';

export interface Diary {
  id: string;
  blueprint_id: string;
  work_date: string;
  weather: string | null;
  temperature_min: number | null;
  temperature_max: number | null;
  work_hours: number | null;
  worker_count: number | null;
  summary: string | null;
  notes: string | null;
  status: string;
  created_by: string | null;
  approved_by: string | null;
  approved_at: string | null;
  created_at: string;
  updated_at: string;
}

@Injectable({ providedIn: 'root' })
export class DiaryRepository {
  private readonly supabase = inject(SupabaseService);

  findByBlueprint(blueprintId: string): Observable<Diary[]> {
    return from(
      this.supabase.client
        .from('diaries')
        .select('*')
        .eq('blueprint_id', blueprintId)
        .is('deleted_at', null)
        .order('work_date', { ascending: false })
    ).pipe(
      map(({ data, error }) => {
        if (error) {
          console.error('[DiaryRepository] findByBlueprint error:', error);
          return [];
        }
        return (data || []) as Diary[];
      })
    );
  }

  findByDate(blueprintId: string, date: string): Observable<Diary | null> {
    return from(
      this.supabase.client
        .from('diaries')
        .select('*')
        .eq('blueprint_id', blueprintId)
        .eq('work_date', date)
        .is('deleted_at', null)
        .single()
    ).pipe(
      map(({ data, error }) => {
        if (error) return null;
        return data as Diary;
      })
    );
  }

  create(diary: Partial<Diary>): Observable<Diary | null> {
    return from(
      this.supabase.client
        .from('diaries')
        .insert(diary)
        .select()
        .single()
    ).pipe(
      map(({ data, error }) => {
        if (error) {
          console.error('[DiaryRepository] create error:', error);
          return null;
        }
        return data as Diary;
      })
    );
  }

  update(id: string, updates: Partial<Diary>): Observable<Diary | null> {
    return from(
      this.supabase.client
        .from('diaries')
        .update({ ...updates, updated_at: new Date().toISOString() })
        .eq('id', id)
        .select()
        .single()
    ).pipe(
      map(({ data, error }) => {
        if (error) {
          console.error('[DiaryRepository] update error:', error);
          return null;
        }
        return data as Diary;
      })
    );
  }
}
```

### 2. DiaryService åƒè€ƒå¯¦ä½œ

```typescript
// src/app/shared/services/diary/diary.service.ts
import { Injectable, inject, signal, computed } from '@angular/core';
import { DiaryRepository, Diary } from '@core';
import { firstValueFrom } from 'rxjs';

@Injectable({ providedIn: 'root' })
export class DiaryService {
  private readonly repo = inject(DiaryRepository);

  // State signals
  private diariesState = signal<Diary[]>([]);
  private loadingState = signal<boolean>(false);
  private errorState = signal<string | null>(null);

  // Readonly signals
  readonly diaries = this.diariesState.asReadonly();
  readonly loading = this.loadingState.asReadonly();
  readonly error = this.errorState.asReadonly();

  // Computed signals
  readonly diaryCount = computed(() => this.diariesState().length);
  readonly hasError = computed(() => this.errorState() !== null);

  async loadDiaries(blueprintId: string): Promise<Diary[]> {
    this.loadingState.set(true);
    this.errorState.set(null);

    try {
      const diaries = await firstValueFrom(this.repo.findByBlueprint(blueprintId));
      this.diariesState.set(diaries);
      return diaries;
    } catch (err) {
      const message = err instanceof Error ? err.message : 'è¼‰å…¥æ—¥èªŒå¤±æ•—';
      this.errorState.set(message);
      throw err;
    } finally {
      this.loadingState.set(false);
    }
  }

  async createDiary(diary: Partial<Diary>): Promise<Diary | null> {
    const newDiary = await firstValueFrom(this.repo.create(diary));
    if (newDiary) {
      this.diariesState.update(list => [newDiary, ...list]);
    }
    return newDiary;
  }

  async updateDiary(id: string, updates: Partial<Diary>): Promise<Diary | null> {
    const updated = await firstValueFrom(this.repo.update(id, updates));
    if (updated) {
      this.diariesState.update(list =>
        list.map(d => d.id === id ? updated : d)
      );
    }
    return updated;
  }
}
```

---

## ğŸ“ ç«‹å³è¡Œå‹•æ¸…å–®

### æœ¬é€± (Week 1) - æ—¥èªŒæ¨¡çµ„åŸºç¤å»ºè¨­

- [ ] **å»ºç«‹ DiaryRepository**
  ```bash
  # å»ºç«‹ç›®éŒ„å’Œæª”æ¡ˆ
  mkdir -p src/app/core/infra/repositories/diary
  touch src/app/core/infra/repositories/diary/diary.repository.ts
  touch src/app/core/infra/repositories/diary/index.ts
  ```
- [ ] **å»ºç«‹ DiaryService**
  ```bash
  mkdir -p src/app/shared/services/diary
  touch src/app/shared/services/diary/diary.service.ts
  touch src/app/shared/services/diary/index.ts
  ```
- [ ] **æ›´æ–° core/index.ts** å°å‡º DiaryRepository
- [ ] **æ›´æ–° shared/index.ts** å°å‡º DiaryService

### ä¸‹é€± (Week 2) - æ—¥èªŒæ¨¡çµ„ UI

- [ ] **å»ºç«‹æ—¥èªŒè·¯ç”±é é¢**
  ```bash
  mkdir -p src/app/routes/blueprint/diary
  touch src/app/routes/blueprint/diary/diary-list.component.ts
  touch src/app/routes/blueprint/diary/diary-form.component.ts
  touch src/app/routes/blueprint/diary/routes.ts
  ```
- [ ] **æ›´æ–°è—åœ–è·¯ç”±** - åŠ å…¥æ—¥èªŒæ¨¡çµ„è·¯ç”±
- [ ] **å»ºç«‹å¤©æ°£é¸æ“‡å™¨å…ƒä»¶** - ä½¿ç”¨ `weather_type` æšèˆ‰
- [ ] **æ—¥èªŒé™„ä»¶åŠŸèƒ½** - æ•´åˆ `diary_attachments` è¡¨

### ç¬¬ä¸‰é€± (Week 3) - æª”æ¡ˆç®¡ç†æ¨¡çµ„

- [ ] **é…ç½® Supabase Storage** - å»ºç«‹ bucket å’Œæ¬Šé™
- [ ] **å»ºç«‹ FileRepository** è³‡æ–™å­˜å–å±¤
- [ ] **å»ºç«‹ FileService** æ¥­å‹™é‚è¼¯
- [ ] **å»ºç«‹æª”æ¡ˆä¸Šå‚³å…ƒä»¶** - æ‹–æ‹‰ä¸Šå‚³
- [ ] **æ•´åˆåˆ°æ—¥èªŒé™„ä»¶** - ç…§ç‰‡ä¸Šå‚³åŠŸèƒ½

### ç¬¬å››é€± (Week 4) - æ¸…ç†å’Œå„ªåŒ–

- [ ] **æ¸…ç† TaskService mock ç¨‹å¼ç¢¼** - ç§»é™¤å·²æ£„ç”¨æ–¹æ³•
- [ ] **ä»»å‹™é™„ä»¶åŠŸèƒ½** - æ•´åˆ FileService
- [ ] **æ¬Šé™æ§åˆ¶å¼·åŒ–** - PermissionDirective
- [ ] **æ¸¬è©¦å’Œæ–‡ä»¶æ›´æ–°**

---

## ğŸ”„ ç‰ˆæœ¬ç‹€æ…‹

### ç•¶å‰ç‰ˆæœ¬

| å¥—ä»¶ | ç‰ˆæœ¬ | ç‹€æ…‹ |
|------|------|------|
| @angular/core | 20.3.0 | âœ… æœ€æ–° |
| @delon/abc | 20.1.0 | âœ… æœ€æ–° |
| ng-zorro-antd | 20.4.3 | âœ… æœ€æ–° |
| @supabase/supabase-js | 2.86.0 | âœ… æœ€æ–° |
| TypeScript | 5.9.2 | âœ… æœ€æ–° |

### Angular 20 ç‰¹æ€§ä½¿ç”¨æƒ…æ³

| ç‰¹æ€§ | ä½¿ç”¨ç‹€æ…‹ | æª”æ¡ˆç¯„ä¾‹ |
|------|---------|---------|
| `signal()`, `computed()` | âœ… å»£æ³›ä½¿ç”¨ | TaskService, BlueprintService |
| `linkedSignal()` | âœ… å·²ä½¿ç”¨ | TaskService.selectedTask |
| `inject()` å‡½æ•¸ | âœ… æ¨™æº–ä½¿ç”¨ | æ‰€æœ‰ Service å’Œ Repository |
| `input()`, `output()` | âœ… éƒ¨åˆ†ä½¿ç”¨ | TaskEditDrawerComponent |
| `@if`, `@for`, `@switch` | âœ… æ¨™æº–ä½¿ç”¨ | æ‰€æœ‰ Component æ¨¡æ¿ |
| `toSignal()`, `toObservable()` | ğŸ”¶ éƒ¨åˆ†ä½¿ç”¨ | å¯æ“´å±•ä½¿ç”¨ |

---

## ğŸ“š ç›¸é—œæ–‡ä»¶

- [ç³»çµ±æ¶æ§‹](GigHub_Architecture.md)
- [åŠŸèƒ½æ–‡ä»¶](features/README.md)
- [ç”¢å“éœ€æ±‚](prd/construction-site-management.md)
- [Supabase Schema](../seed.sql)
- [Angular å®˜æ–¹æ–‡æª”](https://angular.dev)
- [ng-alain æ–‡æª”](https://ng-alain.com)
- [ng-zorro-antd æ–‡æª”](https://ng.ant.design)
- [Supabase æ–‡æª”](https://supabase.com/docs)

---

## ğŸ¯ ç¸½çµ

åŸºæ–¼å°ˆæ¡ˆæœ€æ–°åˆ†æï¼Œ**å»ºè­°çš„é–‹ç™¼é †åº**ç‚ºï¼š

1. **ğŸ“Œ æ–½å·¥æ—¥èªŒæ¨¡çµ„** (æœ€é«˜å„ªå…ˆ) 
   - æ ¸å¿ƒæ¥­å‹™éœ€æ±‚
   - è³‡æ–™åº«çµæ§‹å·²å°±ç·’
   - å¯åƒè€ƒ TaskModule æ¶æ§‹

2. **ğŸ“Œ æª”æ¡ˆç®¡ç†æ¨¡çµ„** (é«˜å„ªå…ˆ)
   - æ”¯æ´æ—¥èªŒå’Œä»»å‹™é™„ä»¶
   - Supabase Storage æ•´åˆ

3. **ğŸ“Œ ä»»å‹™æ¨¡çµ„å®Œå–„** (é«˜å„ªå…ˆ)
   - æ¸…ç† mock ç¨‹å¼ç¢¼
   - é™„ä»¶å’Œè©•è«–åŠŸèƒ½

4. **ğŸ“Œ æ¬Šé™æ§åˆ¶å®Œå–„** (ä¸­å„ªå…ˆ)
   - PermissionDirective
   - ç´°ç²’åº¦å­˜å–æ§åˆ¶

5. **å…¶ä»–æ¨¡çµ„** - æŒ‰éœ€é–‹ç™¼

### ğŸš€ ç«‹å³é–‹å§‹çš„ç¬¬ä¸€æ­¥

```bash
# 1. å»ºç«‹ DiaryRepository
mkdir -p src/app/core/infra/repositories/diary

# 2. å»ºç«‹ DiaryService  
mkdir -p src/app/shared/services/diary

# 3. å»ºç«‹æ—¥èªŒé é¢è·¯ç”±
mkdir -p src/app/routes/blueprint/diary
```

---

## ğŸ“Š åŠŸèƒ½ç¼ºå£åˆ†æï¼ˆContext7 æŸ¥è©¢çµæœï¼‰

> ä»¥ä¸‹åŠŸèƒ½ç¼ºå£åˆ†æåŸºæ–¼ Context7 MCP å·¥å…·æŸ¥è©¢è¡Œæ¥­æ¨™æº–å°ˆæ¡ˆç®¡ç†ç³»çµ±å¾Œï¼Œèˆ‡ GigHub å°ˆæ¡ˆç¾æ³é€²è¡Œæ¯”å°æ‰€å¾—å‡ºã€‚

---

### ğŸ—ï¸ ä¸€ã€å·¥åœ°æ–½å·¥é€²åº¦è¿½è¹¤ç®¡ç†åŸºç¤åŠŸèƒ½ç¼ºå£

**åƒè€ƒä¾†æº**: OpenProject (å°ˆæ¡ˆç®¡ç†ç³»çµ±) + ConstructPro (æ–½å·¥ç®¡ç†å¹³å°)

æ ¹æ“š Context7 æŸ¥è©¢çµæœï¼Œä»¥ä¸‹æ˜¯å·¥åœ°æ–½å·¥é€²åº¦è¿½è¹¤ç®¡ç†ç³»çµ±æ‡‰å…·å‚™çš„**åŸºç¤åŠŸèƒ½**ï¼ˆä¸åŒ…å«åœ–é¢åŠŸèƒ½ï¼‰ï¼š

#### âœ… å·²å¯¦ç¾åŠŸèƒ½

| åŠŸèƒ½ | ç‹€æ…‹ | å°ˆæ¡ˆå¯¦ç¾ |
|------|------|---------|
| ä»»å‹™ CRUD | âœ… 85% | TaskRepository + TaskService |
| ä»»å‹™ç‹€æ…‹æµè½‰ | âœ… | `task_status` æšèˆ‰ |
| ä»»å‹™å„ªå…ˆç´š | âœ… | `task_priority` æšèˆ‰ |
| ä»»å‹™éšå±¤ï¼ˆçˆ¶å­é—œä¿‚ï¼‰ | âœ… | `parent_id` æ¬„ä½ |
| ä»»å‹™æŒ‡æ´¾ | âœ… | `assignee_id` æ¬„ä½ |
| é€²åº¦ç™¾åˆ†æ¯” | âœ… | `completion_rate` æ¬„ä½ |

#### âŒ ç¼ºå¤±çš„åŸºç¤åŠŸèƒ½

| åŠŸèƒ½ | èªªæ˜ | å„ªå…ˆç´š | å»ºè­°å¯¦ç¾æ–¹å¼ |
|------|------|--------|-------------|
| **æ™‚é–“è¿½è¹¤ (Time Tracking)** | è¨˜éŒ„ä»»å‹™çš„å¯¦éš›å·¥æ™‚ | ğŸ”´ é«˜ | æ–°å¢ `task_time_entries` è³‡æ–™è¡¨ |
| **ä»»å‹™è©•è«–ç³»çµ±** | ä»»å‹™å…§è¨è«–å’Œç•™è¨€ | ğŸ”´ é«˜ | ä½¿ç”¨ `task_comments` è³‡æ–™è¡¨ (å·²å­˜åœ¨æ–¼è¨­è¨ˆ) |
| **ä»»å‹™é™„ä»¶ç®¡ç†** | æ–‡ä»¶ã€åœ–ç‰‡é™„åŠ åˆ°ä»»å‹™ | ğŸ”´ é«˜ | æ•´åˆ `task_attachments` + Supabase Storage |
| **ä»»å‹™æ­·å²è¨˜éŒ„** | è¿½è¹¤ä»»å‹™è®Šæ›´ | ğŸŸ  ä¸­ | æ–°å¢ `task_history` è³‡æ–™è¡¨ |
| **ä»»å‹™æ¨™ç±¤ç³»çµ±** | åˆ†é¡å’Œéæ¿¾ä»»å‹™ | ğŸŸ  ä¸­ | æ–°å¢ `task_labels` + `task_label_assignments` |
| **ä»»å‹™æ¨¡æ¿** | é è¨­ä»»å‹™çµæ§‹ | ğŸŸ¡ ä½ | æ–°å¢ `task_templates` è³‡æ–™è¡¨ |
| **ä»»å‹™ä¾è³´é—œä¿‚** | å‰ç½®/å¾ŒçºŒä»»å‹™é—œè¯ | ğŸŸ  ä¸­ | æ–°å¢ `task_dependencies` è³‡æ–™è¡¨ |
| **æ‰¹æ¬¡åŒ¯å…¥åŒ¯å‡º** | Excel/CSV åŒ¯å…¥ä»»å‹™ | ğŸŸ¡ ä½ | å¾Œç«¯ API + å‰ç«¯è§£æ |
| **å¤šä»»å‹™æ‰¹æ¬¡æ“ä½œ** | æ‰¹æ¬¡æ›´æ–°ç‹€æ…‹/æŒ‡æ´¾ | ğŸŸ  ä¸­ | UI + API æ‰¹æ¬¡ç«¯é» |
| **ä»»å‹™æé†’é€šçŸ¥** | æˆªæ­¢æ—¥æœŸæé†’ | ğŸŸ  ä¸­ | æ•´åˆé€šçŸ¥ç³»çµ± |

#### ğŸ“ æ–½å·¥æ—¥èªŒæ¨¡çµ„ç¼ºå£

æ ¹æ“š ConstructPro çš„æ–½å·¥ç®¡ç†æœ€ä½³å¯¦è¸ï¼š

| åŠŸèƒ½ | èªªæ˜ | å„ªå…ˆç´š | å»ºè­°å¯¦ç¾ |
|------|------|--------|---------|
| **æ—¥èªŒæ¢ç›®ç®¡ç†** | æ¯æ—¥å¤šç­†å·¥ä½œè¨˜éŒ„ | ğŸ”´ é«˜ | æ–°å¢ `diary_entries` è³‡æ–™è¡¨ |
| **å¤©æ°£è‡ªå‹•ç²å–** | API æ•´åˆå¤©æ°£æœå‹™ | ğŸŸ¡ ä½ | ç¬¬ä¸‰æ–¹å¤©æ°£ API |
| **äººå“¡å‡ºå‹¤è¨˜éŒ„** | æ¯æ—¥å‡ºå·¥äººæ•¸è©³æƒ… | ğŸŸ  ä¸­ | æ–°å¢ `diary_attendance` |
| **ææ–™ä½¿ç”¨è¨˜éŒ„** | ç•¶æ—¥ææ–™æ¶ˆè€— | ğŸŸ  ä¸­ | æ–°å¢ `diary_materials` |
| **è¨­å‚™ä½¿ç”¨è¨˜éŒ„** | ç•¶æ—¥è¨­å‚™é‹è¡Œ | ğŸŸ  ä¸­ | æ–°å¢ `diary_equipment` |
| **æ—¥èªŒå¯©æ ¸æµç¨‹** | ä¸»ç®¡ç°½æ ¸ | ğŸ”´ é«˜ | `approved_by` + `approved_at` å·²æœ‰ |
| **æ—¥èªŒé–å®šæ©Ÿåˆ¶** | å¯©æ ¸å¾Œä¸å¯ç·¨è¼¯ | ğŸ”´ é«˜ | ç‹€æ…‹æµè½‰æ§åˆ¶ |

#### ğŸ“Š é€²åº¦è¦–è¦ºåŒ–ç¼ºå£

| åŠŸèƒ½ | èªªæ˜ | å„ªå…ˆç´š |
|------|------|--------|
| **ç”˜ç‰¹åœ–è¦–åœ–** | æ™‚é–“è»¸é€²åº¦å±•ç¤º | ğŸ”´ é«˜ |
| **çœ‹æ¿è¦–åœ–** | Kanban é¢¨æ ¼ä»»å‹™ç®¡ç† | âœ… å·²è¨­è¨ˆ (å¾…å¯¦ç¾) |
| **æ—¥æ›†è¦–åœ–** | æŒ‰æ—¥æœŸæŸ¥çœ‹ä»»å‹™ | ğŸŸ  ä¸­ |
| **è³‡æºåˆ†é…è¦–åœ–** | äººå“¡å·¥ä½œè² è¼‰ | ğŸŸ¡ ä½ |
| **é‡Œç¨‹ç¢‘è¿½è¹¤** | é—œéµç¯€é»ç®¡ç† | ğŸŸ  ä¸­ |

---

### ğŸ“¦ äºŒã€é‚è¼¯å®¹å™¨ï¼ˆè—åœ–ç³»çµ±ï¼‰åŠŸèƒ½ç¼ºå£

**åƒè€ƒä¾†æº**: Kubernetes å®¹å™¨ç·¨æ’ + OpenProject å°ˆæ¡ˆç®¡ç†

è—åœ– (Blueprint) ä½œç‚º GigHub çš„æ ¸å¿ƒã€Œé‚è¼¯å®¹å™¨ã€ï¼Œæ‰¿è¼‰å°ˆæ¡ˆæ‰€æœ‰è³‡æ–™å’Œæ¥­å‹™é‚è¼¯ã€‚æ ¹æ“š Context7 æŸ¥è©¢çš„å®¹å™¨æ¶æ§‹æ¨¡å¼ï¼Œä»¥ä¸‹æ˜¯åŠŸèƒ½ç¼ºå£åˆ†æï¼š

#### âœ… å·²å¯¦ç¾çš„å®¹å™¨åŠŸèƒ½

| åŠŸèƒ½ | ç‹€æ…‹ | å¯¦ç¾æ–¹å¼ |
|------|------|---------|
| è—åœ– CRUD | âœ… | BlueprintRepository + BlueprintService |
| è—åœ–æˆå“¡ç®¡ç† | âœ… | `blueprint_members` è³‡æ–™è¡¨ |
| è—åœ–æ¬Šé™è§’è‰² | âœ… | `blueprint_role` æšèˆ‰ |
| æ¥­å‹™è§’è‰² (RBAC) | âœ… | `blueprint_business_role` æšèˆ‰ |
| è‡ªè¨‚è§’è‰²å®šç¾© | ğŸ”¶ 70% | `blueprint_roles` è³‡æ–™è¡¨ |
| åœ˜éšŠæˆæ¬Š | âœ… | `blueprint_team_roles` è³‡æ–™è¡¨ |
| æ¨¡çµ„å•Ÿç”¨æ§åˆ¶ | âœ… | `enabled_modules` æ¬„ä½ |

#### âŒ ç¼ºå¤±çš„å®¹å™¨åŠŸèƒ½

| åŠŸèƒ½ | èªªæ˜ | å„ªå…ˆç´š | åƒè€ƒæ¨¡å¼ |
|------|------|--------|---------|
| **äº‹ä»¶ç¸½ç·š (Event Bus)** | è·¨æ¨¡çµ„äº‹ä»¶å‚³é | ğŸ”´ é«˜ | Kubernetes EventBus æ¨¡å¼ |
| **è—åœ–æ¨¡æ¿** | é è¨­å°ˆæ¡ˆæ¨¡æ¿ | ğŸŸ  ä¸­ | æ¨¡æ¿è¤‡è£½æ©Ÿåˆ¶ |
| **è—åœ–è¤‡è£½/åˆ†å‰** | è¤‡è£½ç¾æœ‰è—åœ– | ğŸŸ  ä¸­ | æ·±åº¦è¤‡è£½é‚è¼¯ |
| **è—åœ–å°å­˜æ©Ÿåˆ¶** | å®Œæˆå°ˆæ¡ˆæ­¸æª” | ğŸŸ¡ ä½ | ç‹€æ…‹ + å”¯è®€æ¨¡å¼ |
| **è—åœ–æ¨™ç±¤åˆ†é¡** | å°ˆæ¡ˆåˆ†é¡æ¨™ç±¤ | ğŸŸ¡ ä½ | `blueprint_labels` è³‡æ–™è¡¨ |
| **è—åœ–æœå°‹å¼•æ“** | å…¨æ–‡æª¢ç´¢ | ğŸ”´ é«˜ | PostgreSQL FTS æˆ– Supabase æœå°‹ |
| **å­˜å–æ—¥èªŒå¯©è¨ˆ** | æ“ä½œè¨˜éŒ„ | ğŸŸ  ä¸­ | `audit_logs` è³‡æ–™è¡¨ |
| **è³‡æºé…é¡ç®¡ç†** | å®¹é‡é™åˆ¶ | ğŸŸ¡ ä½ | å„²å­˜/æˆå“¡æ•¸é™åˆ¶ |

#### ğŸ”§ æ¬Šé™æ§åˆ¶é€²éšéœ€æ±‚

| åŠŸèƒ½ | èªªæ˜ | å„ªå…ˆç´š |
|------|------|--------|
| **ç´°ç²’åº¦æ¬Šé™** | æŒ‰åŠŸèƒ½æ¨¡çµ„æ¬Šé™ | ğŸ”´ é«˜ |
| **æ¬Šé™ç¹¼æ‰¿** | çµ„ç¹”â†’è—åœ–æ¬Šé™ç¹¼æ‰¿ | ğŸŸ  ä¸­ |
| **è‡¨æ™‚å­˜å–** | é™æ™‚å­˜å–æ¬Š | ğŸŸ¡ ä½ |
| **æ¬Šé™å¯©æ‰¹æµ** | å­˜å–è«‹æ±‚å¯©æ ¸ | ğŸŸ¡ ä½ |
| **æ¬Šé™æŒ‡ä»¤å…ƒä»¶** | `*hasPermission` Directive | ğŸ”´ é«˜ |

#### ğŸ“¡ å®¹å™¨ç·¨æ’æ¨¡å¼ç¼ºå£

æ ¹æ“š Kubernetes å®¹å™¨ç·¨æ’æœ€ä½³å¯¦è¸ï¼š

| æ¨¡å¼ | èªªæ˜ | å°ˆæ¡ˆå°æ‡‰ | ç‹€æ…‹ |
|------|------|---------|------|
| **å¥åº·æª¢æŸ¥ (Health Check)** | æœå‹™ç‹€æ…‹ç›£æ§ | è—åœ–ç‹€æ…‹ç›£æ§ | âŒ æœªå¯¦ç¾ |
| **è‡ªå‹•æ“´å±• (Auto-scaling)** | è³‡æºå‹•æ…‹èª¿é… | ä¸é©ç”¨ | N/A |
| **æ»¾å‹•æ›´æ–° (Rolling Update)** | å¹³æ»‘é·ç§» | è³‡æ–™é·ç§»æ©Ÿåˆ¶ | âŒ æœªå¯¦ç¾ |
| **æœå‹™ç™¼ç¾ (Service Discovery)** | æ¨¡çµ„é–“é€šè¨Š | äº‹ä»¶ç¸½ç·š | âŒ æœªå¯¦ç¾ |
| **é…ç½®ç®¡ç† (Config Management)** | ç’°å¢ƒé…ç½® | è—åœ–è¨­å®š | ğŸ”¶ éƒ¨åˆ† |
| **æ—¥èªŒèšåˆ (Log Aggregation)** | é›†ä¸­æ—¥èªŒ | å¯©è¨ˆæ—¥èªŒ | âŒ æœªå¯¦ç¾ |

---

### ğŸ¢ ä¸‰ã€SaaS ä¼æ¥­åŒ–æ¨™æº–åŠŸèƒ½ç¼ºå£

**åƒè€ƒä¾†æº**: Tenancy for Laravel (Multi-tenancy) + SaaSykit + Auth0 B2B SaaS Starter

æ ¹æ“š Context7 æŸ¥è©¢çš„ SaaS ä¼æ¥­åŒ–æ¨™æº–ï¼Œä»¥ä¸‹æ˜¯ GigHub å°ˆæ¡ˆç¼ºå¤±çš„é—œéµåŠŸèƒ½ï¼š

#### âœ… å·²å¯¦ç¾çš„ SaaS åŠŸèƒ½

| åŠŸèƒ½ | ç‹€æ…‹ | å¯¦ç¾æ–¹å¼ |
|------|------|---------|
| å¤šç§Ÿæˆ¶æ¶æ§‹ | âœ… | çµ„ç¹” (Organization) éš”é›¢ |
| ç”¨æˆ¶èªè­‰ | âœ… | Supabase Auth |
| çµ„ç¹”æˆå“¡ç®¡ç† | âœ… | `organization_members` |
| è§’è‰²æ¬Šé™ (RBAC) | ğŸ”¶ 70% | å¤šå±¤è§’è‰²ç³»çµ± |
| Row Level Security | âœ… | PostgreSQL RLS |

#### âŒ ç¼ºå¤±çš„ SaaS ä¼æ¥­åŒ–åŠŸèƒ½

##### ğŸ” èªè­‰èˆ‡å®‰å…¨

| åŠŸèƒ½ | èªªæ˜ | å„ªå…ˆç´š | åƒè€ƒå¯¦ç¾ |
|------|------|--------|---------|
| **SSO/SAML æ•´åˆ** | ä¼æ¥­ç´šå–®ä¸€ç™»å…¥ | ğŸ”´ é«˜ | Supabase SSO |
| **MFA å¤šå› ç´ é©—è­‰** | äºŒæ¬¡é©—è­‰ | ğŸ”´ é«˜ | Supabase MFA |
| **IP ç™½åå–®** | å­˜å–ä¾†æºé™åˆ¶ | ğŸŸ  ä¸­ | çµ„ç¹”è¨­å®š |
| **Session ç®¡ç†** | ç™»å…¥è£ç½®ç®¡ç† | ğŸŸ  ä¸­ | Supabase Sessions |
| **å¯†ç¢¼æ”¿ç­–** | è¤‡é›œåº¦è¦æ±‚ | ğŸŸ  ä¸­ | Auth è¨­å®š |
| **ç™»å…¥ç¨½æ ¸æ—¥èªŒ** | ç™»å…¥è¨˜éŒ„ | ğŸ”´ é«˜ | `auth_audit_logs` |

##### ğŸ’° è¨‚é–±èˆ‡è¨ˆè²»

| åŠŸèƒ½ | èªªæ˜ | å„ªå…ˆç´š | åƒè€ƒå¯¦ç¾ |
|------|------|--------|---------|
| **è¨‚é–±æ–¹æ¡ˆç®¡ç†** | å¤šå±¤ç´šæ–¹æ¡ˆ | ğŸ”´ é«˜ | Stripe æ•´åˆ |
| **ç”¨é‡è¨ˆè²»** | æŒ‰ä½¿ç”¨é‡æ”¶è²» | ğŸŸ  ä¸­ | Usage Tracking |
| **ç™¼ç¥¨ç®¡ç†** | å¸³å–®ç™¼ç¥¨ | ğŸŸ  ä¸­ | Stripe Invoices |
| **ä»˜æ¬¾æ–¹å¼ç®¡ç†** | ä¿¡ç”¨å¡/è½‰å¸³ | ğŸŸ  ä¸­ | Stripe Payments |
| **æ–¹æ¡ˆåŠŸèƒ½é™åˆ¶** | æŒ‰æ–¹æ¡ˆè§£é–åŠŸèƒ½ | ğŸ”´ é«˜ | Feature Flags |
| **è©¦ç”¨æœŸç®¡ç†** | å…è²»è©¦ç”¨ | ğŸŸ  ä¸­ | è¨‚é–±ç‹€æ…‹ |

##### ğŸ‘¥ ç§Ÿæˆ¶ç®¡ç†

| åŠŸèƒ½ | èªªæ˜ | å„ªå…ˆç´š | åƒè€ƒå¯¦ç¾ |
|------|------|--------|---------|
| **çµ„ç¹”é‚€è«‹ç³»çµ±** | é‚€è«‹é€£çµ/Email | âœ… å·²æœ‰åŸºç¤ | éœ€å®Œå–„ |
| **çµ„ç¹”å“ç‰Œè¨­å®š** | Logo/ä¸»é¡Œè‰² | ğŸŸ¡ ä½ | çµ„ç¹”è¨­å®šé é¢ |
| **çµ„ç¹”ç™½æ¨™** | è‡ªè¨‚åŸŸå | ğŸŸ¡ ä½ | DNS + è·¯ç”± |
| **çµ„ç¹”è³‡æ–™åŒ¯å‡º** | GDPR åˆè¦ | ğŸŸ  ä¸­ | è³‡æ–™åŒ¯å‡º API |
| **çµ„ç¹”è³‡æ–™åˆªé™¤** | ç§Ÿæˆ¶éŠ·æ¯€ | ğŸŸ  ä¸­ | Cascade Delete |
| **çµ„ç¹”åˆ‡æ›** | å¤šçµ„ç¹”ç”¨æˆ¶ | âœ… | WorkspaceContext |

##### ğŸ“Š ä¼æ¥­åˆ†æèˆ‡å ±è¡¨

| åŠŸèƒ½ | èªªæ˜ | å„ªå…ˆç´š |
|------|------|--------|
| **ä½¿ç”¨çµ±è¨ˆ Dashboard** | ç®¡ç†å“¡å„€è¡¨æ¿ | ğŸ”´ é«˜ |
| **ç”¨æˆ¶æ´»èºåº¦åˆ†æ** | DAU/MAU | ğŸŸ  ä¸­ |
| **åŠŸèƒ½ä½¿ç”¨è¿½è¹¤** | Feature Usage | ğŸŸ  ä¸­ |
| **æ•ˆèƒ½ç›£æ§** | Response Time | ğŸŸ¡ ä½ |
| **éŒ¯èª¤è¿½è¹¤** | Error Tracking | ğŸŸ  ä¸­ |

##### ğŸ”” é€šçŸ¥èˆ‡æºé€š

| åŠŸèƒ½ | èªªæ˜ | å„ªå…ˆç´š | å°ˆæ¡ˆç‹€æ…‹ |
|------|------|--------|---------|
| **æ‡‰ç”¨å…§é€šçŸ¥** | å³æ™‚é€šçŸ¥ | ğŸ”´ é«˜ | è³‡æ–™è¡¨å·²è¨­è¨ˆ |
| **Email é€šçŸ¥** | éƒµä»¶æé†’ | ğŸ”´ é«˜ | âŒ æœªå¯¦ç¾ |
| **é€šçŸ¥åå¥½è¨­å®š** | ç”¨æˆ¶è¨­å®š | ğŸŸ  ä¸­ | è³‡æ–™è¡¨å·²è¨­è¨ˆ |
| **Webhook æ•´åˆ** | ç¬¬ä¸‰æ–¹æ•´åˆ | ğŸŸ  ä¸­ | âŒ æœªå¯¦ç¾ |
| **Realtime æ¨é€** | å³æ™‚æ›´æ–° | ğŸ”´ é«˜ | Supabase Realtime |

##### ğŸ“ åˆè¦èˆ‡å¯©è¨ˆ

| åŠŸèƒ½ | èªªæ˜ | å„ªå…ˆç´š |
|------|------|--------|
| **æ“ä½œå¯©è¨ˆæ—¥èªŒ** | å®Œæ•´æ“ä½œè¨˜éŒ„ | ğŸ”´ é«˜ |
| **è³‡æ–™å­˜å–æ—¥èªŒ** | æ•æ„Ÿè³‡æ–™å­˜å– | ğŸŸ  ä¸­ |
| **GDPR åˆè¦å·¥å…·** | è³‡æ–™å¯æ”œ/åˆªé™¤ | ğŸŸ  ä¸­ |
| **SLA ç›£æ§** | æœå‹™ç­‰ç´šå”è­° | ğŸŸ¡ ä½ |
| **å‚™ä»½èˆ‡æ¢å¾©** | è³‡æ–™å‚™ä»½ | ğŸ”´ é«˜ |

---

### ğŸ“‹ åŠŸèƒ½ç¼ºå£å„ªå…ˆç´šç¸½çµ

#### ğŸ”´ æœ€é«˜å„ªå…ˆç´šï¼ˆç«‹å³å¯¦ç¾ï¼‰

1. **æ™‚é–“è¿½è¹¤ç³»çµ±** - æ–½å·¥ç®¡ç†æ ¸å¿ƒ
2. **ä»»å‹™è©•è«–åŠŸèƒ½** - åœ˜éšŠå”ä½œå¿…éœ€
3. **é€šçŸ¥ä¸­å¿ƒ** - å³æ™‚è³‡è¨Šæ¨é€
4. **äº‹ä»¶ç¸½ç·š** - æ¨¡çµ„é–“è§£è€¦
5. **æ¬Šé™æŒ‡ä»¤å…ƒä»¶** - UI æ¬Šé™æ§åˆ¶
6. **æ“ä½œå¯©è¨ˆæ—¥èªŒ** - ä¼æ¥­åˆè¦è¦æ±‚
7. **è¨‚é–±æ–¹æ¡ˆç®¡ç†** - SaaS å•†æ¥­æ¨¡å¼

#### ğŸŸ  é«˜å„ªå…ˆç´šï¼ˆçŸ­æœŸç›®æ¨™ï¼‰

1. **ä»»å‹™æ­·å²è¨˜éŒ„** - è®Šæ›´è¿½è¹¤
2. **ä»»å‹™æ¨™ç±¤ç³»çµ±** - åˆ†é¡ç®¡ç†
3. **ä»»å‹™ä¾è³´é—œä¿‚** - é€²åº¦è¦åŠƒ
4. **è—åœ–æ¨¡æ¿** - å¿«é€Ÿå»ºç«‹å°ˆæ¡ˆ
5. **ç´°ç²’åº¦æ¬Šé™** - ç²¾ç¢ºå­˜å–æ§åˆ¶
6. **Email é€šçŸ¥** - éå¯¦æ™‚æé†’

#### ğŸŸ¡ ä¸€èˆ¬å„ªå…ˆç´šï¼ˆä¸­æœŸç›®æ¨™ï¼‰

1. **ä»»å‹™æ¨¡æ¿** - é‡è¤‡ä»»å‹™
2. **æ‰¹æ¬¡åŒ¯å…¥åŒ¯å‡º** - è³‡æ–™é·ç§»
3. **è—åœ–å°å­˜** - å°ˆæ¡ˆæ­¸æª”
4. **çµ„ç¹”å“ç‰Œè¨­å®š** - ç™½æ¨™éœ€æ±‚
5. **å¤©æ°£ API æ•´åˆ** - è‡ªå‹•åŒ–

---

### ğŸ”— ç›¸é—œè³‡æº

- [OpenProject å°ˆæ¡ˆç®¡ç†æ–‡æª”](https://www.openproject.org/docs/)
- [ConstructPro æ–½å·¥ç®¡ç†å¹³å°](https://github.com/ozcanbicervv-create/constructpro-)
- [Tenancy for Laravel å¤šç§Ÿæˆ¶æ¡†æ¶](https://tenancyforlaravel.com/)
- [Finbuckle.MultiTenant .NET å¤šç§Ÿæˆ¶](https://www.finbuckle.com/MultiTenant/)
- [SaaSykit Laravel SaaS å¥—ä»¶](https://saasykit.com/)
- [Auth0 B2B SaaS Starter](https://github.com/auth0-developer-hub/auth0-b2b-saas-starter)
- [Kubernetes å®¹å™¨ç·¨æ’](https://kubernetes.io/docs/)

---

**æœ€å¾Œæ›´æ–°**: 2025-12-03
**åˆ†æåŸºæº–**: å°ˆæ¡ˆæœ€æ–°ç¨‹å¼ç¢¼ç‹€æ…‹ + Context7 MCP æŸ¥è©¢çµæœ
