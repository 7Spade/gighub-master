# 📋 待完成項目清單

> 最後更新: 2025-12-04  
> 總計待完成項目: 105+ 項  
> 總預計工時: ~672h+

---

## 📊 待完成總覽

| 優先級   | 項目數 | 預計工時 | 說明                       |
| -------- | ------ | -------- | -------------------------- |
| 🔴 P0    | 8      | ~22h     | 阻塞性問題，必須立即處理   |
| 🟠 P1    | 18     | ~130h    | 高優先級，影響核心功能     |
| 🟡 P2    | 35     | ~230h    | 中優先級，影響用戶體驗     |
| 🟢 P3    | 20     | ~130h    | 低優先級，可延後實現       |
| 🔵 P4    | 24+    | ~160h+   | 優化項目，持續改進         |

### 基礎設施缺口 (參考 INFRASTRUCTURE_STATUS.md)

| # | 基礎設施 | 當前進度 | 目標進度 | 缺口工時 |
| - | -------- | -------- | -------- | -------- |
| 1 | 上下文注入系統 | 90% | 100% | ~8h |
| 2 | 權限系統 | 75% | 100% | ~26h |
| 3 | 時間軸服務 | 40% | 100% | ~30h |
| 4 | 通知中心 | 50% | 100% | ~32h |
| 5 | 事件總線系統 | 70% | 100% | ~18h |
| 6 | 搜尋引擎系統 | 60% | 100% | ~28h |
| 7 | 關聯管理系統 | 30% | 100% | ~30h |
| 8 | 資料隔離系統 | 85% | 100% | ~14h |
| 9 | 生命週期管理 | 40% | 100% | ~19h |
| 10 | 配置中心 | 0% | 100% | ~30h |
| 11 | 元數據系統 | 0% | 100% | ~28h |
| 12 | API 閘道 | 30% | 100% | ~32h |

---

## 🔴 P0 - 阻塞性問題 (必須立即處理)

### 1. 藍圖編輯功能缺失

**問題**: 藍圖建立後無法編輯，編輯按鈕顯示「編輯功能開發中」

| 待完成項目                | 預計工時 | 優先級 |
| ------------------------- | -------- | ------ |
| 藍圖編輯抽屜/頁面組件     | 4h       | P0     |
| 藍圖基本資訊編輯 API      | 2h       | P0     |
| 模組啟用/停用功能         | 2h       | P0     |
| 藍圖狀態變更功能          | 1h       | P0     |
| 藍圖封面上傳功能          | 2h       | P0     |

### 2. 藍圖概覽頁面資訊架構問題

**問題**: 財務資訊顯示在概覽頁面頂部，應移至財務 Tab

| 待完成項目                | 預計工時 | 優先級 |
| ------------------------- | -------- | ------ |
| 財務統計卡片移至財務 Tab  | 2h       | P0     |
| 概覽頁面重新設計          | 3h       | P0     |
| 財務模組權限分離          | 2h       | P0     |

### 3. Mock 資料移除

**問題**: 任務管理在載入失敗時使用 Mock 資料

| 待完成項目                | 預計工時 | 優先級 |
| ------------------------- | -------- | ------ |
| 移除 Mock 資料後備機制    | 1h       | P0     |
| 添加適當的錯誤處理 UI     | 2h       | P0     |
| 添加重試機制              | 1h       | P0     |

---

## 🟠 P1 - 高優先級 (核心功能)

### 4. 時間軸服務完善 (Timeline Service) - 目前 40%

**目標進度**: 100%

| 待完成項目                | 說明                        | 預計工時 |
| ------------------------- | --------------------------- | -------- |
| 跨模組活動追蹤 UI         | 整合到藍圖概覽頁面          | 6h       |
| 完整操作歷史視圖          | 時間軸列表組件              | 4h       |
| 版本控制                  | before/after snapshots, diff | 8h       |
| 審計軌跡                  | who, when, what, why, where  | 6h       |
| 多時間軸視圖              | 全域、模組、用戶、資源      | 6h       |

### 5. 通知中心完善 (Notification Hub) - 目前 50%

**目標進度**: 100%

| 待完成項目                | 說明                        | 預計工時 |
| ------------------------- | --------------------------- | -------- |
| 通知中心 UI 組件          | 下拉面板 + 全頁視圖         | 6h       |
| 排程通知                  | 到期日提醒                  | 4h       |
| 摘要通知                  | 日/週報告                   | 4h       |
| 多頻道路由                | App push, Email, Webhook    | 8h       |
| 訂閱管理 UI               | 用戶偏好設定                | 4h       |
| 智慧合併                  | 防止通知轟炸                | 4h       |
| 勿擾模式                  | 時間段設定                  | 2h       |

### 6. 搜尋引擎完善 (Search Engine) - 目前 60%

**目標進度**: 100%

| 待完成項目                | 說明                        | 預計工時 |
| ------------------------- | --------------------------- | -------- |
| 全域搜尋面板              | Header 搜尋框整合           | 4h       |
| 關聯搜尋                  | 任務關聯日誌、檔案關聯任務  | 6h       |
| 即時索引                  | Supabase Realtime 整合      | 4h       |
| 權限感知過濾              | 基於用戶權限過濾結果        | 4h       |
| 進階搜尋 UI               | 建立者、狀態、日期、標籤    | 6h       |
| 搜尋分析與報告            | 熱門搜尋、搜尋趨勢          | 4h       |

### 7. 事件總線完善 (Event Bus) - 目前 70%

**目標進度**: 100%

| 待完成項目                | 說明                        | 預計工時 |
| ------------------------- | --------------------------- | -------- |
| 事件重放能力              | 歷史事件重放                | 6h       |
| 整合事件                  | Webhook triggers, API calls | 8h       |
| 事件持久化                | 事件歷史記錄                | 4h       |

---

## 🟡 P2 - 中優先級 (用戶體驗)

### 8. 日誌管理完善 (Diary Management) - 目前 60%

| 待完成項目                | 說明                        | 預計工時 |
| ------------------------- | --------------------------- | -------- |
| 日誌建立/編輯 UI          | 抽屜組件                    | 6h       |
| 日誌列表頁面              | 支援篩選和搜尋              | 4h       |
| 日誌詳情頁面              | 包含附件和評論              | 4h       |
| 日誌附件上傳              | 整合 Supabase Storage       | 4h       |
| 日誌模板功能              | 預設模板管理                | 4h       |
| 日誌審核流程              | 審核狀態和流程              | 6h       |

### 9. 品質驗收完善 (Quality Acceptance) - 目前 50%

| 待完成項目                | 說明                        | 預計工時 |
| ------------------------- | --------------------------- | -------- |
| 品質驗收建立 UI           | 驗收表單                    | 6h       |
| 驗收清單管理              | 檢查項目 CRUD               | 4h       |
| 驗收項目檢查              | 逐項驗收 UI                 | 4h       |
| 問題追蹤整合              | 關聯問題建立                | 4h       |
| 驗收報告生成              | PDF 導出                    | 6h       |
| 驗收流程工作流            | 審批流程                    | 6h       |

### 10. 檔案管理完善 (File Management) - 目前 50%

| 待完成項目                | 說明                        | 預計工時 |
| ------------------------- | --------------------------- | -------- |
| 檔案上傳 UI               | 拖放上傳 + 進度條           | 4h       |
| 檔案列表/瀏覽             | 網格/列表視圖               | 4h       |
| 檔案預覽                  | 圖片、PDF、Office           | 8h       |
| 檔案分類與標籤            | 分類管理 UI                 | 4h       |
| 版本控制                  | 檔案歷史版本                | 6h       |
| 檔案權限管理              | 共享和存取控制              | 6h       |

### 11. 關聯管理系統完善 (Relation Manager) - 目前 30%

| 待完成項目                | 說明                        | 預計工時 |
| ------------------------- | --------------------------- | -------- |
| 任務 ↔ 任務 父子關聯      | 依賴關係管理                | 4h       |
| 任務 ↔ 檔案 關聯          | 附件關聯                    | 3h       |
| 任務 ↔ 日誌 關聯          | 日誌關聯                    | 3h       |
| 級聯刪除處理              | 關聯資料清理                | 4h       |
| 循環參照檢測              | 防止無限循環                | 4h       |
| 關聯完整性維護            | 完整性檢查                  | 4h       |
| 關聯視覺化 UI             | 關係圖組件                  | 8h       |

### 12. 生命週期管理完善 (Lifecycle Management) - 目前 40%

| 待完成項目                | 說明                        | 預計工時 |
| ------------------------- | --------------------------- | -------- |
| 狀態轉換規則強制執行      | 狀態機實現                  | 4h       |
| 資料保留政策              | 保留期限設定                | 4h       |
| 已刪除記錄自動清理        | 定時清理任務                | 4h       |
| 狀態轉換鉤子              | 前置/後置處理               | 4h       |
| 生命週期事件通知          | 狀態變更通知                | 3h       |

---

## 🟢 P3 - 低優先級 (進階功能)

### 13. 配置中心 (Configuration Center) - 目前 0%

| 待完成項目                | 說明                        | 預計工時 |
| ------------------------- | --------------------------- | -------- |
| 藍圖級別配置              | 工作時間、狀態、優先級      | 8h       |
| 標籤系統                  | 自訂標籤管理                | 4h       |
| 通知設定                  | 藍圖通知偏好                | 4h       |
| 配置驗證                  | Schema 驗證                 | 4h       |
| 配置繼承                  | 組織 → 藍圖 繼承            | 4h       |
| 配置 UI                   | 設定頁面                    | 6h       |

### 14. 元數據系統 (Metadata System) - 目前 0%

| 待完成項目                | 說明                        | 預計工時 |
| ------------------------- | --------------------------- | -------- |
| 基礎元數據                | 名稱、描述、封面、主題      | 4h       |
| 分類系統                  | 產業、專案類型              | 4h       |
| 自訂欄位                  | 動態欄位定義                | 8h       |
| Schema 版本控制           | 欄位版本管理                | 6h       |
| 欄位遷移腳本              | 資料遷移                    | 6h       |

### 15. API 閘道完善 (API Gateway) - 目前 30%

| 待完成項目                | 說明                        | 預計工時 |
| ------------------------- | --------------------------- | -------- |
| 速率限制                  | API 請求限制                | 4h       |
| API 配額管理              | 配額追蹤和警告              | 4h       |
| Webhook 出站              | 外部事件通知                | 6h       |
| OAuth 整合                | Google, Microsoft, GitHub   | 12h      |
| CORS 配置                 | 跨域設定                    | 2h       |
| API 版本控制              | 版本管理                    | 4h       |

### 16. 權限系統完善 - 目前 75%

| 待完成項目                | 說明                        | 預計工時 |
| ------------------------- | --------------------------- | -------- |
| 權限快取策略              | Redis/Memory 快取           | 4h       |
| 動態權限計算              | 多角色權限合併              | 6h       |
| 資源級別權限檢查          | 細粒度權限                  | 6h       |
| 權限管理 UI               | 權限設定頁面                | 6h       |
| 角色建立/編輯             | 自訂角色                    | 4h       |

### 17. 上下文注入系統完善 - 目前 90%

| 待完成項目                | 說明                        | 預計工時 |
| ------------------------- | --------------------------- | -------- |
| 藍圖特定上下文注入        | 藍圖級別上下文              | 4h       |
| 配置注入                  | 時區、語言、工作時間        | 4h       |
| 上下文快取策略            | 效能優化                    | 3h       |

### 18. 資料隔離系統完善 - 目前 85%

| 待完成項目                | 說明                        | 預計工時 |
| ------------------------- | --------------------------- | -------- |
| 配額管理                  | 儲存、成員、API 配額        | 6h       |
| 跨藍圖存取阻擋            | 資料隔離強化                | 4h       |
| 敏感資料遮罩              | 資料遮罩規則                | 4h       |

---

## 🔵 P4 - 優化項目 (持續改進)

### 19. 前端 UI 組件開發

| 待完成項目                | 說明                        | 預計工時 |
| ------------------------- | --------------------------- | -------- |
| 通知中心下拉面板          | Header 通知圖標             | 4h       |
| 搜尋結果面板優化          | 更好的結果展示              | 4h       |
| 時間軸視覺化組件          | 時間軸列表                  | 6h       |
| 關聯視覺化組件            | 關係圖                      | 8h       |
| 檔案預覽組件              | 內嵌預覽                    | 8h       |
| 圖表統計組件              | ECharts 整合                | 6h       |

### 20. 頁面優化

| 待完成項目                | 說明                        | 預計工時 |
| ------------------------- | --------------------------- | -------- |
| 藍圖概覽 - 活動時間軸整合 | 時間軸 Tab 實現             | 4h       |
| 儀表板 - 統計圖表         | Dashboard 圖表              | 6h       |
| 成員管理 - 權限編輯       | 權限設定 UI                 | 4h       |
| 成員資訊顯示優化          | 顯示名稱而非 account_id     | 2h       |

### 21. 測試覆蓋

| 待完成項目                | 目標覆蓋率 | 預計工時 |
| ------------------------- | ---------- | -------- |
| 核心服務單元測試          | 80%+       | 16h      |
| Store 單元測試            | 100%       | 8h       |
| Utils 單元測試            | 100%       | 4h       |
| Supabase 整合測試         | 70%+       | 12h      |
| 認證流程測試              | 90%+       | 6h       |
| 權限系統測試              | 90%+       | 8h       |
| E2E 登入/登出流程         | 100%       | 4h       |
| E2E 藍圖 CRUD 流程        | 100%       | 6h       |
| E2E 任務管理流程          | 100%       | 8h       |

### 22. 文檔完善

| 待完成項目                | 說明                        | 預計工時 |
| ------------------------- | --------------------------- | -------- |
| API 文檔                  | OpenAPI/Swagger             | 8h       |
| 部署文檔                  | Docker + K8s 部署指南       | 6h       |
| 開發者指南                | 開發環境設定                | 4h       |
| 用戶手冊                  | 功能使用說明                | 8h       |
| Supabase 函數文檔         | Edge Functions 文檔         | 4h       |

### 23. 效能優化

| 待完成項目                | 說明                        | 預計工時 |
| ------------------------- | --------------------------- | -------- |
| Bundle 大小優化           | Lazy Loading 完善           | 4h       |
| 虛擬滾動                  | 大列表效能                  | 4h       |
| 圖片優化                  | 壓縮 + CDN                  | 4h       |
| API 快取策略              | 資料快取                    | 6h       |

### 24. 程式碼品質

| 待完成項目                | 說明                        | 預計工時 |
| ------------------------- | --------------------------- | -------- |
| 大型組件拆分              | tasks.component 拆分        | 6h       |
| 服務依賴解耦              | 循環依賴清理                | 4h       |
| 日期格式統一              | DatePipe 統一使用           | 2h       |
| 錯誤訊息國際化            | i18n 整合                   | 4h       |

---

## 🎯 實施路線圖

### Phase 1: 阻塞問題修復 (1-2 週)

1. ✅ 藍圖編輯功能實現
2. ✅ 概覽頁面資訊架構修正
3. ✅ Mock 資料移除

### Phase 2: 核心功能完善 (3-4 週)

4. 時間軸服務 UI 整合
5. 通知中心 UI 實現
6. 搜尋面板優化
7. 事件總線完善

### Phase 3: 用戶體驗提升 (4-6 週) - ~130h

8. 日誌管理 UI
9. 品質驗收 UI
10. 檔案管理 UI
11. 關聯視覺化

### Phase 4: 進階功能 (6-8 週) - ~120h

12. 配置中心
13. 元數據系統
14. API 閘道完善
15. 權限系統完善

### Phase 5: 持續優化 (持續進行) - ~160h+

16. 測試覆蓋提升 (目標: 80%+)
17. 文檔完善 (API 文檔、用戶手冊)
18. 效能優化 (Bundle 大小、虛擬滾動)
19. 程式碼品質 (大型組件拆分、循環依賴)

---

## 📊 工時估算

| 優先級 | 項目數 | 預計總工時 |
| ------ | ------ | ---------- |
| P0     | 8      | ~22h       |
| P1     | 18     | ~130h      |
| P2     | 25     | ~160h      |
| P3     | 20     | ~130h      |
| P4     | 24+    | ~160h+     |
| **總計** | **95+** | **~600h+** |

---

## 📁 待建立的檔案/組件

### 業務組件 (待建立)

| 組件名稱 | 路徑 | 優先級 |
| -------- | ---- | ------ |
| 藍圖編輯抽屜 | `src/app/routes/blueprint/edit-blueprint/` | P0 |
| 通知中心面板 | `src/app/routes/notification/` | P1 |
| 時間軸列表 | `src/app/routes/blueprint/timeline/` | P1 |
| 搜尋結果頁面 | `src/app/routes/search/` | P1 |
| 日誌建立/編輯 | `src/app/routes/blueprint/diary/` | P2 |
| 品質驗收頁面 | `src/app/routes/blueprint/quality/` | P2 |
| 檔案管理頁面 | `src/app/routes/blueprint/files/` | P2 |
| 配置中心頁面 | `src/app/routes/settings/` | P3 |

### 服務 (待完善)

| 服務 | 當前進度 | 待完成功能 |
| ---- | -------- | ---------- |
| timeline.service | 40% | UI 整合、版本控制、審計軌跡 |
| notification.service | 50% | 排程通知、多頻道路由、智慧合併 |
| search.service | 60% | 全域搜尋面板、權限感知過濾 |
| event-bus.service | 70% | 事件重放、整合事件 |

### 資料庫 (待建立)

| 資料表/函數 | 優先級 | 說明 |
| ----------- | ------ | ---- |
| configuration 表 | P3 | 藍圖配置中心 |
| metadata 表 | P3 | 自訂欄位系統 |
| notification_subscriptions 表 | P1 | 通知訂閱管理 |
| audit_trail 視圖 | P1 | 完整審計軌跡 |

---

## 🔧 技術債清理待辦

| 編號 | 待辦項目 | 優先級 | 預計工時 |
| ---- | -------- | ------ | -------- |
| TD-CLN-001 | 清理所有 Mock 資料和後備機制 | P0 | 6h |
| TD-CLN-002 | 移除 Deprecated 方法 | P1 | 4h |
| TD-CLN-003 | 替換 any 類型為具體型別 | P2 | 8h |
| TD-CLN-004 | 清理 console.log 語句 | P2 | 4h |
| TD-CLN-005 | 拆分大型組件 (>500行) | P2 | 24h |
| TD-CLN-006 | 解耦複雜服務依賴 | P3 | 8h |
| TD-CLN-007 | 統一錯誤處理模式 | P3 | 6h |
| TD-CLN-008 | 統一日期格式使用 | P3 | 2h |
| TD-CLN-009 | 移除 Placeholder 程式碼 | P2 | 4h |
| TD-CLN-010 | 建立統一 Logger 服務 | P2 | 4h |

---

## 📊 工時估算

| 優先級 | 項目數 | 預計總工時 |
| ------ | ------ | ---------- |
| P0     | 8      | ~22h       |
| P1     | 18     | ~130h      |
| P2     | 35     | ~230h      |
| P3     | 20     | ~130h      |
| P4     | 24+    | ~160h+     |
| **總計** | **105+** | **~672h+** |

---

**最後更新**: 2025-12-04
