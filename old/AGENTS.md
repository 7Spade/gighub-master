# AGENTS.md - NG-ALAIN Enterprise Project Guidelines

> **æ ¸å¿ƒåŸå‰‡**: ä¼æ¥­åŒ–æ¨™æº– + å¥§å¡å§†å‰ƒåˆ€ (Occam's Razor) - ä»¥æœ€ç°¡æ½”çš„æ–¹å¼è§£æ±ºå•é¡Œ

---

## ä¸€ã€å°ˆæ¡ˆæ¦‚è¿°

æœ¬å°ˆæ¡ˆåŸºæ–¼ **NG-ALAIN** ä¼æ¥­ç´šä¸­å¾Œå°å‰ç«¯æ¡†æ¶ï¼Œæ•´åˆ **Angular 20+**ã€**@delon** å’Œ **ng-zorro-antd**ï¼Œæ¡ç”¨ä»¥ä¸‹æ¶æ§‹æ¨¡å¼ï¼š

- **æ©«å‘åˆ†å±¤æ¶æ§‹**ï¼šé©ç”¨æ–¼ `core`ã€`shared`ã€`routes`ã€`layout` å±¤
- **å‚ç›´åˆ‡ç‰‡æ¶æ§‹**ï¼šé©ç”¨æ–¼ `features` å±¤

---

## äºŒã€æŠ€è¡“æ£§èˆ‡å„ªå…ˆç´š

### 2.1 UI å…ƒä»¶ä½¿ç”¨å„ªå…ˆç´š

```
å„ªå…ˆç´šï¼šNG-ZORRO > NG-ALAIN (@delon/abc) > è‡ªè¡Œé–‹ç™¼
```

| å„ªå…ˆç´š | ä¾†æº | èªªæ˜ |
|--------|------|------|
| ğŸ¥‡ 1st | `ng-zorro-antd` | Ant Design Angular å¯¦ç¾ï¼ŒåŸºç¤ UI å…ƒä»¶ |
| ğŸ¥ˆ 2nd | `@delon/abc` | ä¼æ¥­ç´šæ¥­å‹™å…ƒä»¶ (ST, SE, SV, SF ç­‰) |
| ğŸ¥‰ 3rd | è‡ªè¡Œé–‹ç™¼ | **åƒ…åœ¨ä¸Šè¿°ç„¡æ³•æ»¿è¶³éœ€æ±‚æ™‚** |

### 2.2 å…±äº«å°å…¥å„ªå…ˆä½¿ç”¨

```typescript
// âœ… å„ªå…ˆä½¿ç”¨ shared-imports.ts
import { SHARED_IMPORTS } from '@shared';

@Component({
  imports: [...SHARED_IMPORTS],
})
```

è©³è¦‹ï¼š`src/app/shared/shared-imports.ts`

---

## ä¸‰ã€æ¶æ§‹æ¨¡å¼

### 3.1 æ©«å‘åˆ†å±¤æ¶æ§‹ï¼ˆHorizontal Layeredï¼‰

é©ç”¨æ–¼ï¼š`core`ã€`shared`ã€`routes`ã€`layout`

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  layout/                    â”‚ â† ç‰ˆé¢é…ç½®
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  routes/                    â”‚ â† è·¯ç”±é é¢
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  shared/                    â”‚ â† å…±äº«è³‡æº
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   core/                     â”‚ â† æ ¸å¿ƒæœå‹™
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 å‚ç›´åˆ‡ç‰‡æ¶æ§‹ï¼ˆVertical Sliceï¼‰

é©ç”¨æ–¼ï¼š`features/`

```
features/
â””â”€â”€ blueprint/              â† åŠŸèƒ½æ¨¡çµ„ (Feature)
    â”œâ”€â”€ data-access/        â† è³‡æ–™å­˜å–å±¤
    â”‚   â”œâ”€â”€ stores/         â† Signal Stores (ç‹€æ…‹ç®¡ç†)
    â”‚   â”œâ”€â”€ repositories/   â† è³‡æ–™å­˜å–æŠ½è±¡
    â”‚   â””â”€â”€ services/       â† æ¥­å‹™é‚è¼¯æœå‹™
    â”œâ”€â”€ domain/             â† é ˜åŸŸå±¤
    â”‚   â”œâ”€â”€ models/         â† é ˜åŸŸæ¨¡å‹
    â”‚   â”œâ”€â”€ interfaces/     â† ä»‹é¢å®šç¾©
    â”‚   â”œâ”€â”€ types/          â† å‹åˆ¥å®šç¾©
    â”‚   â””â”€â”€ enums/          â† åˆ—èˆ‰å®šç¾©
    â”œâ”€â”€ shell/              â† Shell å…ƒä»¶ (Smart Components)
    â”œâ”€â”€ ui/                 â† UI å…ƒä»¶ (Presentational)
    â”œâ”€â”€ guards/             â† è·¯ç”±å®ˆè¡›
    â”œâ”€â”€ directives/         â† æŒ‡ä»¤
    â”œâ”€â”€ pipes/              â† ç®¡é“
    â”œâ”€â”€ utils/              â† å·¥å…·å‡½æ•¸
    â””â”€â”€ constants/          â† å¸¸æ•¸é…ç½®
```

---

## å››ã€ç‹€æ…‹ç®¡ç†æ¨™æº–

### 4.1 ç‹€æ…‹ç®¡ç†æµå‘

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     UI Component                        â”‚
â”‚                         â”‚                               â”‚
â”‚                         â–¼                               â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚    â”‚          Store (Signal Store)            â”‚        â”‚
â”‚    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚        â”‚
â”‚    â”‚   â”‚    Signal State Management       â”‚   â”‚        â”‚
â”‚    â”‚   â”‚    - state = signal({...})       â”‚   â”‚        â”‚
â”‚    â”‚   â”‚    - computed signals            â”‚   â”‚        â”‚
â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚        â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                         â”‚                               â”‚
â”‚                         â–¼                               â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚    â”‚         Repository / Service             â”‚        â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                         â”‚                               â”‚
â”‚                         â–¼                               â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚    â”‚            Supabase Client               â”‚        â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 Store åœ¨å‚ç›´åˆ‡ç‰‡ä¸­çš„ä½ç½®

```
features/[feature-name]/
â””â”€â”€ data-access/
    â””â”€â”€ stores/           â† Signal Stores æ”¾ç½®æ–¼æ­¤
        â”œâ”€â”€ [feature].store.ts
        â””â”€â”€ index.ts
```

---

## äº”ã€èªè­‰èˆ‡æˆæ¬Šæµç¨‹

### 5.1 èªè­‰æµç¨‹éˆ

```
Supabase Auth â†’ @delon/auth â†’ DA_SERVICE_TOKEN â†’ @delon/acl
```

| éšæ®µ | å…ƒä»¶ | è·è²¬ |
|------|------|------|
| 1 | `SupabaseService` | Supabase èªè­‰æ•´åˆ |
| 2 | `@delon/auth` | Token ç®¡ç† (TokenService) |
| 3 | `DA_SERVICE_TOKEN` | Token å­˜å–æŠ½è±¡ |
| 4 | `@delon/acl` | æ¬Šé™æ§åˆ¶ (ACL) |

### 5.2 èªè­‰ç‹€æ…‹ç®¡ç†

```typescript
// core/services/auth-context.service.ts
// ä½¿ç”¨ Angular Signals ç®¡ç†èªè­‰ç‹€æ…‹
readonly authState = signal<AuthStateData>({...});
readonly isAuthenticated = computed(() => this.authState().status === 'authenticated');
```

---

## å…­ã€Angular 20+ æ¨¡æ¿èªæ³•è¦ç¯„

### 6.1 æ–°æ§åˆ¶æµèªæ³•

```html
<!-- âœ… ä½¿ç”¨æ–°èªæ³• -->
@if (isLoading()) {
  <nz-spin></nz-spin>
} @else {
  <div>Content</div>
}

@for (item of items(); track item.id) {
  <div>{{ item.name }}</div>
}

@switch (status()) {
  @case ('active') { <span>Active</span> }
  @case ('inactive') { <span>Inactive</span> }
  @default { <span>Unknown</span> }
}
```

### 6.2 Signal è¼¸å…¥/è¼¸å‡ºï¼ˆAngular 19+ï¼‰

```typescript
// âœ… ä½¿ç”¨æ–°çš„ Signal API
export class MyComponent {
  // Inputs
  readonly data = input<Data>();
  readonly required = input.required<string>();

  // Outputs
  readonly save = output<Data>();

  // ViewChild
  readonly template = viewChild<TemplateRef>('tmpl');
}
```

---

## ä¸ƒã€æ¨¡çµ„é‚Šç•Œç®¡ç†

### 7.1 å…¬é–‹ API åŸå‰‡

```typescript
// features/blueprint/index.ts
// åªå°å‡ºæ‡‰è©²å°å¤–å…¬é–‹çš„éƒ¨åˆ†
export { BLUEPRINT_ROUTES } from './blueprint.routes';
export * from './domain';     // é ˜åŸŸé¡å‹
export * from './constants';  // å¸¸æ•¸é…ç½®
// âš ï¸ ä¸è¦å°å‡ºå…§éƒ¨å¯¦ç¾ç´°ç¯€
```

### 7.2 ä¾è³´æ–¹å‘

```
features â†’ shared â†’ core
    â”‚         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â†’ @delon/* / ng-zorro-antd
```

---

## å…«ã€Context7 MCP æŸ¥è©¢åˆ¤æ–·

> **èªªæ˜**ï¼šæ­¤æŒ‡å¼•é‡å° AI Agent (å¦‚ GitHub Copilot) åœ¨ç”¢ç”Ÿç¨‹å¼ç¢¼æ™‚çš„æŸ¥è©¢ç­–ç•¥

### 8.1 ä½•æ™‚ä½¿ç”¨ Context7 MCP

| æƒ…æ³ | æ˜¯å¦ä½¿ç”¨ MCP |
|------|--------------|
| AI Agent æœ‰çµ•å°æŠŠæ¡ï¼ˆå¸¸è¦‹ APIã€æ¨™æº–æ¨¡å¼ï¼‰ | âŒ ä¸æŸ¥ |
| AI Agent æ²’æœ‰æŠŠæ¡ï¼ˆæ–°åŠŸèƒ½ã€ç‰ˆæœ¬ç‰¹å®šã€é‚Šç·£æƒ…æ³ï¼‰ | âœ… ä½¿ç”¨ MCP |
| @delon ç‰¹å®š API | âœ… å»ºè­°æŸ¥è©¢ |
| NG-ZORRO é€²éšç”¨æ³• | âœ… å»ºè­°æŸ¥è©¢ |
| Angular æ–°ç‰ˆæœ¬ç‰¹æ€§ | âœ… å»ºè­°æŸ¥è©¢ |

### 8.2 å°é–‹ç™¼è€…çš„å»ºè­°

ç•¶ä½¿ç”¨ AI åŠ©æ‰‹ç”¢ç”Ÿç¨‹å¼ç¢¼æ™‚ï¼Œå¯åƒè€ƒä»¥ä¸Šç­–ç•¥åˆ¤æ–·æ˜¯å¦éœ€è¦é¡å¤–æŸ¥è©¢æ–‡æª”ã€‚

---

## ä¹ã€å–®ä¸€è·è²¬åŸå‰‡ (SRP)

### 9.1 å„å±¤è·è²¬

| å±¤ç´š | è·è²¬ | ç¦æ­¢äº‹é … |
|------|------|----------|
| `core/` | å…¨å±€æœå‹™ã€èªè­‰ã€æ””æˆªå™¨ | ä¸åŒ…å« UI å…ƒä»¶ |
| `shared/` | å…±äº«å…ƒä»¶ã€æŒ‡ä»¤ã€ç®¡é“ | ä¸åŒ…å«æ¥­å‹™é‚è¼¯ |
| `layout/` | ç‰ˆé¢é…ç½®å…ƒä»¶ | ä¸åŒ…å«æ¥­å‹™é‚è¼¯ |
| `routes/` | è·¯ç”±é é¢å…ƒä»¶ | è¤‡é›œé‚è¼¯æ‡‰å§”æ´¾çµ¦ feature |
| `features/` | å®Œæ•´æ¥­å‹™åŠŸèƒ½æ¨¡çµ„ | ä¸ç›´æ¥ä¾è³´å…¶ä»– feature |

---

## åã€åºåˆ—åŒ–æ€è€ƒ (Sequential Thinking)

åœ¨é€²è¡Œé–‹ç™¼æ™‚ï¼Œè«‹éµå¾ªä»¥ä¸‹æ€è€ƒé †åºï¼š

1. **ç†è§£éœ€æ±‚** - ç¢ºèªè¦è§£æ±ºçš„å•é¡Œ
2. **æª¢æŸ¥ç¾æœ‰** - æ˜¯å¦å·²æœ‰é¡ä¼¼å¯¦ç¾
3. **é¸æ“‡æ¨¡å¼** - æ©«å‘åˆ†å±¤ vs å‚ç›´åˆ‡ç‰‡
4. **å…ƒä»¶å„ªå…ˆ** - NG-ZORRO â†’ @delon/abc â†’ è‡ªè¡Œé–‹ç™¼
5. **ç‹€æ…‹ç®¡ç†** - ä½¿ç”¨ Angular Signals
6. **æ¸¬è©¦é©—è­‰** - ç¢ºä¿åŠŸèƒ½æ­£ç¢º
7. **æ–‡æª”æ›´æ–°** - ç¶­è­·ç›¸é—œ AGENTS.md

---

## åä¸€ã€ç›®éŒ„çµæ§‹æ¦‚è¦½

```
src/app/
â”œâ”€â”€ core/                   # æ ¸å¿ƒå±¤ (æ©«å‘åˆ†å±¤)
â”‚   â”œâ”€â”€ facades/           # Facade æ¨¡å¼
â”‚   â”œâ”€â”€ i18n/              # åœ‹éš›åŒ–
â”‚   â”œâ”€â”€ infra/             # åŸºç¤è¨­æ–½
â”‚   â”œâ”€â”€ net/               # ç¶²è·¯å±¤
â”‚   â”œâ”€â”€ services/          # æ ¸å¿ƒæœå‹™
â”‚   â””â”€â”€ startup/           # å•Ÿå‹•æœå‹™
â”œâ”€â”€ shared/                 # å…±äº«å±¤ (æ©«å‘åˆ†å±¤)
â”‚   â”œâ”€â”€ base/              # åŸºç¤å…ƒä»¶
â”‚   â”œâ”€â”€ directives/        # å…±äº«æŒ‡ä»¤
â”‚   â”œâ”€â”€ pipes/             # å…±äº«ç®¡é“
â”‚   â”œâ”€â”€ services/          # å…±äº«æœå‹™
â”‚   â”œâ”€â”€ models/            # å…±äº«æ¨¡å‹
â”‚   â””â”€â”€ utils/             # å·¥å…·å‡½æ•¸
â”œâ”€â”€ layout/                 # ç‰ˆé¢å±¤ (æ©«å‘åˆ†å±¤)
â”‚   â”œâ”€â”€ basic/             # åŸºç¤ç‰ˆé¢
â”‚   â”œâ”€â”€ blank/             # ç©ºç™½ç‰ˆé¢
â”‚   â””â”€â”€ passport/          # ç™»å…¥ç‰ˆé¢
â”œâ”€â”€ routes/                 # è·¯ç”±å±¤ (æ©«å‘åˆ†å±¤)
â”‚   â”œâ”€â”€ account/           # å¸³æˆ¶é é¢
â”‚   â”œâ”€â”€ demo/              # ç¤ºç¯„é é¢
â”‚   â”œâ”€â”€ exception/         # ä¾‹å¤–é é¢
â”‚   â””â”€â”€ passport/          # ç™»å…¥é é¢
â””â”€â”€ features/               # åŠŸèƒ½å±¤ (å‚ç›´åˆ‡ç‰‡)
    â””â”€â”€ blueprint/         # Blueprint åŠŸèƒ½æ¨¡çµ„
        â”œâ”€â”€ data-access/   # è³‡æ–™å­˜å–
        â”œâ”€â”€ domain/        # é ˜åŸŸæ¨¡å‹
        â”œâ”€â”€ shell/         # Smart Components
        â”œâ”€â”€ ui/            # Presentational Components
        â””â”€â”€ ...
```

---

## åäºŒã€ç›¸é—œ AGENTS.md

- [`src/app/AGENTS.md`](src/app/AGENTS.md) - æ‡‰ç”¨å±¤ç´šæŒ‡å¼•
- [`src/app/core/AGENTS.md`](src/app/core/AGENTS.md) - Core å±¤æŒ‡å¼•
- [`src/app/shared/AGENTS.md`](src/app/shared/AGENTS.md) - Shared å±¤æŒ‡å¼•
- [`src/app/layout/AGENTS.md`](src/app/layout/AGENTS.md) - Layout å±¤æŒ‡å¼•
- [`src/app/routes/AGENTS.md`](src/app/routes/AGENTS.md) - Routes å±¤æŒ‡å¼•
- [`src/app/features/AGENTS.md`](src/app/features/AGENTS.md) - Features å±¤æŒ‡å¼•
- [`src/app/features/blueprint/AGENTS.md`](src/app/features/blueprint/AGENTS.md) - Blueprint åŠŸèƒ½æŒ‡å¼•
